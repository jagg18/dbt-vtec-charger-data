[0m15:06:19.686306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906bc50>]}


============================== 15:06:19.692486 | a88b3156-721c-4c37-a2b1-e542b0dd6c09 ==============================
[0m15:06:19.692486 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:06:19.693149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:19.718109 [info ] [MainThread]: dbt version: 1.9.4
[0m15:06:19.718844 [info ] [MainThread]: python version: 3.13.2
[0m15:06:19.719325 [info ] [MainThread]: python path: /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/venv_dbt/bin/python3.13
[0m15:06:19.719686 [info ] [MainThread]: os info: macOS-15.0.1-x86_64-i386-64bit-Mach-O
[0m15:06:19.797080 [info ] [MainThread]: Using profiles dir at /Users/jerome-norbit/.dbt
[0m15:06:19.797562 [info ] [MainThread]: Using profiles.yml file at /Users/jerome-norbit/.dbt/profiles.yml
[0m15:06:19.797871 [info ] [MainThread]: Using dbt_project.yml file at /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/dbt_project.yml
[0m15:06:19.798774 [info ] [MainThread]: adapter type: postgres
[0m15:06:19.799108 [info ] [MainThread]: adapter version: 1.9.0
[0m15:06:19.904639 [info ] [MainThread]: Configuration:
[0m15:06:19.905132 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:06:19.905451 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:06:19.905730 [info ] [MainThread]: Required dependencies:
[0m15:06:19.906119 [debug] [MainThread]: Executing "git --help"
[0m15:06:19.932706 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:06:19.933924 [debug] [MainThread]: STDERR: "b''"
[0m15:06:19.934317 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:06:19.934663 [info ] [MainThread]: Connection:
[0m15:06:19.935034 [info ] [MainThread]:   host: localhost
[0m15:06:19.935328 [info ] [MainThread]:   port: 5432
[0m15:06:19.935591 [info ] [MainThread]:   user: kestra
[0m15:06:19.935870 [info ] [MainThread]:   database: postgres-zoomcamp
[0m15:06:19.936125 [info ] [MainThread]:   schema: vtec_dbt_test
[0m15:06:19.936388 [info ] [MainThread]:   connect_timeout: 10
[0m15:06:19.936666 [info ] [MainThread]:   role: None
[0m15:06:19.936922 [info ] [MainThread]:   search_path: None
[0m15:06:19.937177 [info ] [MainThread]:   keepalives_idle: 0
[0m15:06:19.937434 [info ] [MainThread]:   sslmode: None
[0m15:06:19.937688 [info ] [MainThread]:   sslcert: None
[0m15:06:19.937958 [info ] [MainThread]:   sslkey: None
[0m15:06:19.938255 [info ] [MainThread]:   sslrootcert: None
[0m15:06:19.938540 [info ] [MainThread]:   application_name: dbt
[0m15:06:19.938932 [info ] [MainThread]:   retries: 1
[0m15:06:19.939690 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:06:20.050553 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:06:20.111209 [debug] [MainThread]: Using postgres connection "debug"
[0m15:06:20.111655 [debug] [MainThread]: On debug: select 1 as id
[0m15:06:20.111970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:20.200468 [debug] [MainThread]: SQL status: SELECT 1 in 0.088 seconds
[0m15:06:20.201573 [debug] [MainThread]: On debug: Close
[0m15:06:20.201960 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:06:20.202341 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:06:20.204488 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.59981245, "process_in_blocks": "0", "process_kernel_time": 0.407954, "process_mem_max_rss": "105996288", "process_out_blocks": "0", "process_user_time": 1.727551}
[0m15:06:20.205131 [debug] [MainThread]: Command `dbt debug` succeeded at 15:06:20.204991 after 0.60 seconds
[0m15:06:20.205501 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:06:20.205868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e81220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109720dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109184380>]}
[0m15:06:20.206319 [debug] [MainThread]: Flushing usage events
[0m15:06:20.424088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:44.275735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fda270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107367ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107367c50>]}


============================== 15:07:44.282510 | 055677af-fabb-41cd-a123-83bafad98a49 ==============================
[0m15:07:44.282510 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:07:44.283288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:07:44.509031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789dba0>]}
[0m15:07:44.573170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f9480>]}
[0m15:07:44.574441 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:07:44.689094 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:07:44.690039 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:07:44.690431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077fcd50>]}
[0m15:07:45.918470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dba030>]}
[0m15:07:45.989342 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:07:45.992485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:07:46.022962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077fa6d0>]}
[0m15:07:46.023476 [info ] [MainThread]: Found 2 models, 4 data tests, 433 macros
[0m15:07:46.023828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802b520>]}
[0m15:07:46.025674 [info ] [MainThread]: 
[0m15:07:46.026065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:46.026384 [info ] [MainThread]: 
[0m15:07:46.026873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:46.031381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m15:07:46.099886 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m15:07:46.100299 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m15:07:46.100602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:46.154002 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.053 seconds
[0m15:07:46.155456 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m15:07:46.156210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now create_postgres-zoomcamp_vtec_dbt_test)
[0m15:07:46.156798 [debug] [ThreadPool]: Creating schema "database: "postgres-zoomcamp"
schema: "vtec_dbt_test"
"
[0m15:07:46.161682 [debug] [ThreadPool]: Using postgres connection "create_postgres-zoomcamp_vtec_dbt_test"
[0m15:07:46.162080 [debug] [ThreadPool]: On create_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:07:46.162365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:46.174563 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:07:46.175007 [debug] [ThreadPool]: Using postgres connection "create_postgres-zoomcamp_vtec_dbt_test"
[0m15:07:46.175317 [debug] [ThreadPool]: On create_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_postgres-zoomcamp_vtec_dbt_test"} */
create schema if not exists "vtec_dbt_test"
[0m15:07:46.180115 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m15:07:46.181192 [debug] [ThreadPool]: On create_postgres-zoomcamp_vtec_dbt_test: COMMIT
[0m15:07:46.181888 [debug] [ThreadPool]: Using postgres connection "create_postgres-zoomcamp_vtec_dbt_test"
[0m15:07:46.182235 [debug] [ThreadPool]: On create_postgres-zoomcamp_vtec_dbt_test: COMMIT
[0m15:07:46.207757 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m15:07:46.208489 [debug] [ThreadPool]: On create_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:07:46.210674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres-zoomcamp_vtec_dbt_test, now list_postgres-zoomcamp_vtec_dbt_test)
[0m15:07:46.218725 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:07:46.219345 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:07:46.219767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:46.233689 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m15:07:46.234131 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:07:46.234452 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:07:46.242483 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m15:07:46.243872 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:07:46.244894 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:07:46.249648 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:46.250067 [debug] [MainThread]: On master: BEGIN
[0m15:07:46.250365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:46.262900 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:07:46.263368 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:46.263743 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:07:46.272054 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:07:46.273376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108321790>]}
[0m15:07:46.273849 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:46.274902 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:46.275318 [debug] [MainThread]: On master: BEGIN
[0m15:07:46.276802 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:07:46.277194 [debug] [MainThread]: On master: COMMIT
[0m15:07:46.277516 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:46.277787 [debug] [MainThread]: On master: COMMIT
[0m15:07:46.278604 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:07:46.279008 [debug] [MainThread]: On master: Close
[0m15:07:46.284956 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:07:46.285665 [info ] [Thread-1 (]: 1 of 2 START sql table model vtec_dbt_test.my_first_dbt_model .................. [RUN]
[0m15:07:46.286308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.my_first_dbt_model)
[0m15:07:46.286788 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:07:46.295289 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:07:46.296816 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:07:46.346136 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m15:07:46.347706 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:07:46.348151 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m15:07:46.348512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:46.364404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:07:46.364939 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:07:46.365367 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:07:46.379384 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.014 seconds
[0m15:07:46.389911 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:07:46.390528 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:07:46.393824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:07:46.411095 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m15:07:46.411588 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:07:46.411952 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m15:07:46.417219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:07:46.423367 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model__dbt_backup"
[0m15:07:46.428431 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:07:46.428848 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model__dbt_backup" cascade
[0m15:07:46.431014 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:07:46.433573 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m15:07:46.435888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bb800>]}
[0m15:07:46.436780 [info ] [Thread-1 (]: 1 of 2 OK created sql table model vtec_dbt_test.my_first_dbt_model ............. [[32mSELECT 2[0m in 0.15s]
[0m15:07:46.437501 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:07:46.438388 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m15:07:46.438874 [info ] [Thread-1 (]: 2 of 2 START sql view model vtec_dbt_test.my_second_dbt_model .................. [RUN]
[0m15:07:46.439348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m15:07:46.439724 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m15:07:46.442494 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m15:07:46.444285 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m15:07:46.469273 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m15:07:46.470275 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m15:07:46.470659 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m15:07:46.470998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:46.483637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:07:46.484137 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m15:07:46.484506 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model"
where id = 1
  );
[0m15:07:46.489451 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:07:46.492568 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m15:07:46.492968 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:07:46.494234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:46.495876 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m15:07:46.496369 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m15:07:46.496769 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m15:07:46.500174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:07:46.502494 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."my_second_dbt_model__dbt_backup"
[0m15:07:46.505623 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m15:07:46.506091 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."my_second_dbt_model__dbt_backup" cascade
[0m15:07:46.507213 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:07:46.508666 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m15:07:46.509272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055677af-fabb-41cd-a123-83bafad98a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8574d0>]}
[0m15:07:46.509947 [info ] [Thread-1 (]: 2 of 2 OK created sql view model vtec_dbt_test.my_second_dbt_model ............. [[32mCREATE VIEW[0m in 0.07s]
[0m15:07:46.510710 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m15:07:46.512157 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:46.512548 [debug] [MainThread]: On master: BEGIN
[0m15:07:46.512835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:46.525922 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:07:46.526393 [debug] [MainThread]: On master: COMMIT
[0m15:07:46.526711 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:46.526983 [debug] [MainThread]: On master: COMMIT
[0m15:07:46.527711 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:46.528046 [debug] [MainThread]: On master: Close
[0m15:07:46.528503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:46.528817 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m15:07:46.529147 [info ] [MainThread]: 
[0m15:07:46.529747 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m15:07:46.531392 [debug] [MainThread]: Command end result
[0m15:07:46.552739 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:07:46.555462 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:07:46.562390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:07:46.562872 [info ] [MainThread]: 
[0m15:07:46.563320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:46.563671 [info ] [MainThread]: 
[0m15:07:46.564062 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:07:46.566218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.37185, "process_in_blocks": "0", "process_kernel_time": 0.492212, "process_mem_max_rss": "117956608", "process_out_blocks": "0", "process_user_time": 3.352757}
[0m15:07:46.566737 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:46.566620 after 2.37 seconds
[0m15:07:46.567117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ef750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a64a0>]}
[0m15:07:46.567478 [debug] [MainThread]: Flushing usage events
[0m15:07:46.776934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:35.769773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104552270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590bc50>]}


============================== 15:12:35.776194 | ccbdddfa-3024-4c43-b031-c63c4b801b5c ==============================
[0m15:12:35.776194 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:12:35.776953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:12:35.918030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccbdddfa-3024-4c43-b031-c63c4b801b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db6520>]}
[0m15:12:35.938580 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:12:35.939524 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:12:35.942049 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2719669, "process_in_blocks": "0", "process_kernel_time": 0.305113, "process_mem_max_rss": "95395840", "process_out_blocks": "0", "process_user_time": 1.880921}
[0m15:12:35.942938 [debug] [MainThread]: Command `cli deps` succeeded at 15:12:35.942738 after 0.27 seconds
[0m15:12:35.943767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105898e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105783e50>]}
[0m15:12:35.944266 [debug] [MainThread]: Flushing usage events
[0m15:12:36.241682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:25.298261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107312270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108697ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108697c50>]}


============================== 15:15:25.309578 | 6189d099-23f0-44ae-aee6-32558a34cc6c ==============================
[0m15:15:25.309578 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:15:25.310235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:15:25.453413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6189d099-23f0-44ae-aee6-32558a34cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b76520>]}
[0m15:15:25.482850 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:15:25.485329 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:15:25.487708 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.28607127, "process_in_blocks": "0", "process_kernel_time": 0.379237, "process_mem_max_rss": "96063488", "process_out_blocks": "0", "process_user_time": 1.836707}
[0m15:15:25.488304 [debug] [MainThread]: Command `cli deps` succeeded at 15:15:25.488176 after 0.29 seconds
[0m15:15:25.488709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851be50>]}
[0m15:15:25.489228 [debug] [MainThread]: Flushing usage events
[0m15:15:25.752070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:45.500214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1c6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11054bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11054bc50>]}


============================== 15:16:45.506171 | 7d4e343e-52f8-4f5e-ab82-857ad01f31ed ==============================
[0m15:16:45.506171 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:16:45.506902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:45.519576 [info ] [MainThread]: dbt version: 1.9.4
[0m15:16:45.520005 [info ] [MainThread]: python version: 3.13.2
[0m15:16:45.520425 [info ] [MainThread]: python path: /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/venv_dbt/bin/python3.13
[0m15:16:45.520974 [info ] [MainThread]: os info: macOS-15.0.1-x86_64-i386-64bit-Mach-O
[0m15:16:45.591214 [info ] [MainThread]: Using profiles dir at /Users/jerome-norbit/.dbt
[0m15:16:45.591765 [info ] [MainThread]: Using profiles.yml file at /Users/jerome-norbit/.dbt/profiles.yml
[0m15:16:45.592136 [info ] [MainThread]: Using dbt_project.yml file at /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/dbt_project.yml
[0m15:16:45.592988 [info ] [MainThread]: adapter type: postgres
[0m15:16:45.593406 [info ] [MainThread]: adapter version: 1.9.0
[0m15:16:45.758231 [info ] [MainThread]: Configuration:
[0m15:16:45.758680 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:16:45.758985 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:16:45.759261 [info ] [MainThread]: Required dependencies:
[0m15:16:45.759636 [debug] [MainThread]: Executing "git --help"
[0m15:16:45.796902 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:16:45.797955 [debug] [MainThread]: STDERR: "b''"
[0m15:16:45.798346 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:16:45.798690 [info ] [MainThread]: Connection:
[0m15:16:45.799020 [info ] [MainThread]:   host: localhost
[0m15:16:45.799291 [info ] [MainThread]:   port: 5432
[0m15:16:45.799553 [info ] [MainThread]:   user: kestra
[0m15:16:45.799829 [info ] [MainThread]:   database: postgres-zoomcamp
[0m15:16:45.800106 [info ] [MainThread]:   schema: vtec_dbt_test
[0m15:16:45.800403 [info ] [MainThread]:   connect_timeout: 10
[0m15:16:45.800681 [info ] [MainThread]:   role: None
[0m15:16:45.800937 [info ] [MainThread]:   search_path: None
[0m15:16:45.801189 [info ] [MainThread]:   keepalives_idle: 0
[0m15:16:45.801447 [info ] [MainThread]:   sslmode: None
[0m15:16:45.801694 [info ] [MainThread]:   sslcert: None
[0m15:16:45.801945 [info ] [MainThread]:   sslkey: None
[0m15:16:45.802200 [info ] [MainThread]:   sslrootcert: None
[0m15:16:45.802447 [info ] [MainThread]:   application_name: dbt
[0m15:16:45.802695 [info ] [MainThread]:   retries: 1
[0m15:16:45.803972 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:16:45.919617 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:16:45.983901 [debug] [MainThread]: Using postgres connection "debug"
[0m15:16:45.984341 [debug] [MainThread]: On debug: select 1 as id
[0m15:16:45.984674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:46.060770 [debug] [MainThread]: SQL status: SELECT 1 in 0.076 seconds
[0m15:16:46.062883 [debug] [MainThread]: On debug: Close
[0m15:16:46.064296 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:16:46.064832 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:16:46.066879 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6647221, "process_in_blocks": "0", "process_kernel_time": 0.306427, "process_mem_max_rss": "106655744", "process_out_blocks": "0", "process_user_time": 1.683449}
[0m15:16:46.067477 [debug] [MainThread]: Command `dbt debug` succeeded at 15:16:46.067343 after 0.67 seconds
[0m15:16:46.067880 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:16:46.068253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113650f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11065c380>]}
[0m15:16:46.068710 [debug] [MainThread]: Flushing usage events
[0m15:16:46.314667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:42.645053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a42270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df7c50>]}


============================== 15:25:42.651992 | 1e080fc8-b28f-40ef-804c-c748580b8aa6 ==============================
[0m15:25:42.651992 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:25:42.652639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:25:42.682044 [info ] [MainThread]: dbt version: 1.9.4
[0m15:25:42.682913 [info ] [MainThread]: python version: 3.13.2
[0m15:25:42.683656 [info ] [MainThread]: python path: /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/venv_dbt/bin/python3.13
[0m15:25:42.684656 [info ] [MainThread]: os info: macOS-15.0.1-x86_64-i386-64bit-Mach-O
[0m15:25:42.772662 [info ] [MainThread]: Using profiles dir at /Users/jerome-norbit/.dbt
[0m15:25:42.773152 [info ] [MainThread]: Using profiles.yml file at /Users/jerome-norbit/.dbt/profiles.yml
[0m15:25:42.773489 [info ] [MainThread]: Using dbt_project.yml file at /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/dbt_project.yml
[0m15:25:42.774341 [info ] [MainThread]: adapter type: postgres
[0m15:25:42.774748 [info ] [MainThread]: adapter version: 1.9.0
[0m15:25:42.895837 [info ] [MainThread]: Configuration:
[0m15:25:42.896327 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:25:42.896637 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:25:42.896908 [info ] [MainThread]: Required dependencies:
[0m15:25:42.897292 [debug] [MainThread]: Executing "git --help"
[0m15:25:42.938185 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:25:42.939256 [debug] [MainThread]: STDERR: "b''"
[0m15:25:42.939653 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:25:42.940044 [info ] [MainThread]: Connection:
[0m15:25:42.940523 [info ] [MainThread]:   host: localhost
[0m15:25:42.940873 [info ] [MainThread]:   port: 5432
[0m15:25:42.941172 [info ] [MainThread]:   user: kestra
[0m15:25:42.941457 [info ] [MainThread]:   database: postgres-zoomcamp
[0m15:25:42.941732 [info ] [MainThread]:   schema: vtec_dbt_test
[0m15:25:42.942008 [info ] [MainThread]:   connect_timeout: 10
[0m15:25:42.942274 [info ] [MainThread]:   role: None
[0m15:25:42.942558 [info ] [MainThread]:   search_path: None
[0m15:25:42.943346 [info ] [MainThread]:   keepalives_idle: 0
[0m15:25:42.944003 [info ] [MainThread]:   sslmode: None
[0m15:25:42.944416 [info ] [MainThread]:   sslcert: None
[0m15:25:42.944884 [info ] [MainThread]:   sslkey: None
[0m15:25:42.946657 [info ] [MainThread]:   sslrootcert: None
[0m15:25:42.947438 [info ] [MainThread]:   application_name: dbt
[0m15:25:42.947942 [info ] [MainThread]:   retries: 1
[0m15:25:42.948808 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:25:43.066656 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:25:43.129162 [debug] [MainThread]: Using postgres connection "debug"
[0m15:25:43.129634 [debug] [MainThread]: On debug: select 1 as id
[0m15:25:43.129949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:43.169857 [debug] [MainThread]: SQL status: SELECT 1 in 0.040 seconds
[0m15:25:43.170959 [debug] [MainThread]: On debug: Close
[0m15:25:43.171343 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:25:43.171771 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:25:43.173933 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.61685276, "process_in_blocks": "0", "process_kernel_time": 0.444024, "process_mem_max_rss": "106569728", "process_out_blocks": "0", "process_user_time": 1.82463}
[0m15:25:43.174700 [debug] [MainThread]: Command `dbt debug` succeeded at 15:25:43.174389 after 0.62 seconds
[0m15:25:43.175311 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:25:43.175783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c090f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11249cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0c380>]}
[0m15:25:43.176325 [debug] [MainThread]: Flushing usage events
[0m15:25:43.388886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:14.817493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d286270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e637ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e637c50>]}


============================== 15:29:14.824242 | c154df89-e3b5-47e1-b2f2-f11bb0dafcf8 ==============================
[0m15:29:14.824242 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:29:14.824887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:14.851671 [info ] [MainThread]: dbt version: 1.9.4
[0m15:29:14.852116 [info ] [MainThread]: python version: 3.13.2
[0m15:29:14.852476 [info ] [MainThread]: python path: /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/venv_dbt/bin/python3.13
[0m15:29:14.852763 [info ] [MainThread]: os info: macOS-15.0.1-x86_64-i386-64bit-Mach-O
[0m15:29:14.931080 [info ] [MainThread]: Using profiles dir at /Users/jerome-norbit/.dbt
[0m15:29:14.931727 [info ] [MainThread]: Using profiles.yml file at /Users/jerome-norbit/.dbt/profiles.yml
[0m15:29:14.932500 [info ] [MainThread]: Using dbt_project.yml file at /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/dbt_project.yml
[0m15:29:14.933586 [info ] [MainThread]: adapter type: postgres
[0m15:29:14.934153 [info ] [MainThread]: adapter version: 1.9.0
[0m15:29:15.048299 [info ] [MainThread]: Configuration:
[0m15:29:15.048831 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:29:15.049420 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:29:15.049808 [info ] [MainThread]: Required dependencies:
[0m15:29:15.050298 [debug] [MainThread]: Executing "git --help"
[0m15:29:15.071161 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:29:15.072233 [debug] [MainThread]: STDERR: "b''"
[0m15:29:15.072630 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:29:15.072972 [info ] [MainThread]: Connection:
[0m15:29:15.073323 [info ] [MainThread]:   host: localhost
[0m15:29:15.073611 [info ] [MainThread]:   port: 5432
[0m15:29:15.073874 [info ] [MainThread]:   user: kestra
[0m15:29:15.074125 [info ] [MainThread]:   database: postgres-zoomcamp
[0m15:29:15.074388 [info ] [MainThread]:   schema: vtec_dbt_test
[0m15:29:15.074653 [info ] [MainThread]:   connect_timeout: 10
[0m15:29:15.074911 [info ] [MainThread]:   role: None
[0m15:29:15.075189 [info ] [MainThread]:   search_path: None
[0m15:29:15.075488 [info ] [MainThread]:   keepalives_idle: 0
[0m15:29:15.075750 [info ] [MainThread]:   sslmode: None
[0m15:29:15.075999 [info ] [MainThread]:   sslcert: None
[0m15:29:15.076247 [info ] [MainThread]:   sslkey: None
[0m15:29:15.076494 [info ] [MainThread]:   sslrootcert: None
[0m15:29:15.076741 [info ] [MainThread]:   application_name: dbt
[0m15:29:15.076991 [info ] [MainThread]:   retries: 1
[0m15:29:15.078333 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:15.197870 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:29:15.263353 [debug] [MainThread]: Using postgres connection "debug"
[0m15:29:15.263861 [debug] [MainThread]: On debug: select 1 as id
[0m15:29:15.264192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:15.299609 [debug] [MainThread]: SQL status: SELECT 1 in 0.035 seconds
[0m15:29:15.300804 [debug] [MainThread]: On debug: Close
[0m15:29:15.301241 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:29:15.301884 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:29:15.304222 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5795899, "process_in_blocks": "0", "process_kernel_time": 0.42477, "process_mem_max_rss": "106500096", "process_out_blocks": "0", "process_user_time": 1.844979}
[0m15:29:15.304903 [debug] [MainThread]: Command `dbt debug` succeeded at 15:29:15.304694 after 0.58 seconds
[0m15:29:15.305348 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:29:15.305742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f44d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ece4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e750380>]}
[0m15:29:15.306197 [debug] [MainThread]: Flushing usage events
[0m15:29:15.518221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:34.036511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112072270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113423ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113423c50>]}


============================== 15:29:34.041760 | e74a30aa-6b71-4111-9717-703d8bbdb48f ==============================
[0m15:29:34.041760 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:29:34.042426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:34.257870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e74a30aa-6b71-4111-9717-703d8bbdb48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113959ba0>]}
[0m15:29:34.330537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e74a30aa-6b71-4111-9717-703d8bbdb48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b1480>]}
[0m15:29:34.332103 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:34.446484 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:29:34.582864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:34.583331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:34.636335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e74a30aa-6b71-4111-9717-703d8bbdb48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138aaf50>]}
[0m15:29:34.735096 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:29:34.738943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:29:34.760629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e74a30aa-6b71-4111-9717-703d8bbdb48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113906b70>]}
[0m15:29:34.761230 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 433 macros
[0m15:29:34.761833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e74a30aa-6b71-4111-9717-703d8bbdb48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114241c50>]}
[0m15:29:34.785799 [info ] [MainThread]: 
[0m15:29:34.788409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:34.788825 [info ] [MainThread]: 
[0m15:29:34.789993 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:34.818015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp_vtec_dbt_test'
[0m15:29:34.894397 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:29:34.894856 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:29:34.895179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:34.923261 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m15:29:34.923822 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:29:34.924179 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:29:34.930007 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m15:29:34.932283 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:29:34.933302 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:29:34.938104 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:34.938532 [debug] [MainThread]: On master: BEGIN
[0m15:29:34.938822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:34.950327 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:29:34.950786 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:34.951172 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:34.957045 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m15:29:34.958591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e74a30aa-6b71-4111-9717-703d8bbdb48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11443f380>]}
[0m15:29:34.959025 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:34.959819 [debug] [MainThread]: On master: Close
[0m15:29:34.963032 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:29:34.963584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.my_first_dbt_model)
[0m15:29:34.963975 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:29:34.970858 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:29:34.971759 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:29:34.972521 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:29:34.972914 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:29:34.973283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:29:34.973757 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:29:34.975930 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:29:34.976835 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:29:34.977535 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:29:34.977915 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m15:29:34.978293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now model.jaffle_shop.my_second_dbt_model)
[0m15:29:34.978634 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m15:29:34.980954 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m15:29:34.981827 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m15:29:34.982689 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m15:29:34.983084 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:29:34.983467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_second_dbt_model, now test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:29:34.983808 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:29:34.998753 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:29:34.999989 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:29:35.000725 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:29:35.001109 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:29:35.001475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m15:29:35.001812 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:29:35.007516 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:29:35.008311 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:29:35.008988 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:29:35.009361 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:29:35.009721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m15:29:35.010083 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:29:35.013901 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:29:35.014829 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:29:35.015581 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:29:35.015953 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:29:35.016302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:29:35.016639 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:29:35.020437 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:29:35.021423 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:29:35.022249 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:29:35.023377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:35.023701 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:29:35.025101 [debug] [MainThread]: Command end result
[0m15:29:35.042163 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:29:35.044075 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:29:35.051118 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:29:35.052963 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.1069853, "process_in_blocks": "0", "process_kernel_time": 0.341727, "process_mem_max_rss": "112947200", "process_out_blocks": "0", "process_user_time": 2.278348}
[0m15:29:35.053461 [debug] [MainThread]: Command `dbt compile` succeeded at 15:29:35.053347 after 1.11 seconds
[0m15:29:35.053846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113321cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145c8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145c8e10>]}
[0m15:29:35.054205 [debug] [MainThread]: Flushing usage events
[0m15:29:35.259316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:20.678985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b04a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d3c50>]}


============================== 15:30:20.684012 | 66548764-cacd-4be4-b66d-c5e8a534b62b ==============================
[0m15:30:20.684012 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:30:20.685070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:30:20.866746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66548764-cacd-4be4-b66d-c5e8a534b62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c909ba0>]}
[0m15:30:20.928641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66548764-cacd-4be4-b66d-c5e8a534b62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c365480>]}
[0m15:30:20.929684 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:30:21.030615 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:30:21.158836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:21.159301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:21.204979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66548764-cacd-4be4-b66d-c5e8a534b62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c86ef50>]}
[0m15:30:21.286230 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:30:21.289917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:30:21.303914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66548764-cacd-4be4-b66d-c5e8a534b62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8b6b70>]}
[0m15:30:21.304465 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 433 macros
[0m15:30:21.304851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66548764-cacd-4be4-b66d-c5e8a534b62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f6190>]}
[0m15:30:21.306933 [info ] [MainThread]: 
[0m15:30:21.307327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:21.307662 [info ] [MainThread]: 
[0m15:30:21.308214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:21.313367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp_vtec_dbt_test'
[0m15:30:21.362448 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:30:21.362920 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:30:21.363242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:21.398118 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:30:21.398585 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:30:21.398927 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:30:21.405841 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:30:21.407342 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:30:21.408357 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:30:21.413123 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:21.413558 [debug] [MainThread]: On master: BEGIN
[0m15:30:21.413878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:21.425171 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:30:21.425664 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:21.426045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:21.429893 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m15:30:21.431524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66548764-cacd-4be4-b66d-c5e8a534b62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ef2b0>]}
[0m15:30:21.431963 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:21.433144 [debug] [MainThread]: On master: Close
[0m15:30:21.435455 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:30:21.436097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.my_first_dbt_model)
[0m15:30:21.436504 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:30:21.443427 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:30:21.444304 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:30:21.445046 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:30:21.445450 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:30:21.445826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:30:21.446186 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:30:21.449127 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:30:21.450159 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:30:21.450885 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:30:21.451260 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m15:30:21.451623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now model.jaffle_shop.my_second_dbt_model)
[0m15:30:21.451968 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m15:30:21.454202 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m15:30:21.455001 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m15:30:21.455769 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m15:30:21.456179 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:30:21.456549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_second_dbt_model, now test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:30:21.456886 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:30:21.472289 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:30:21.473280 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:30:21.474030 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:30:21.474413 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:30:21.474777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m15:30:21.475128 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:30:21.480951 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:30:21.481768 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:30:21.482468 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:30:21.482918 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:30:21.483347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m15:30:21.483706 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:30:21.487643 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:30:21.488487 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:30:21.489214 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:30:21.489611 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:30:21.490026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:30:21.490533 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:30:21.494603 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:30:21.495375 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:30:21.496059 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:30:21.497117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:21.497470 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:30:21.498897 [debug] [MainThread]: Command end result
[0m15:30:21.516248 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:30:21.518222 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:30:21.525998 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:30:21.527765 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.94536984, "process_in_blocks": "0", "process_kernel_time": 0.321322, "process_mem_max_rss": "112840704", "process_out_blocks": "0", "process_user_time": 2.22655}
[0m15:30:21.528562 [debug] [MainThread]: Command `dbt compile` succeeded at 15:30:21.528401 after 0.95 seconds
[0m15:30:21.528997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d56c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d56cd60>]}
[0m15:30:21.529390 [debug] [MainThread]: Flushing usage events
[0m15:30:21.784080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:55.641417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108077ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108077c50>]}


============================== 15:44:55.648817 | ad80c19e-5b4f-4e9f-b65d-bf115bc61233 ==============================
[0m15:44:55.648817 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:44:55.649560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:55.854798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad80c19e-5b4f-4e9f-b65d-bf115bc61233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b5ba0>]}
[0m15:44:55.917294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad80c19e-5b4f-4e9f-b65d-bf115bc61233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108009480>]}
[0m15:44:55.918672 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:56.049324 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:44:56.220349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:44:56.221161 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_sources.yml
[0m15:44:56.519050 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.stg_postgres__meter_readings' (models/staging/stg_postgres__meter_readings.sql) depends on a source named 'ekm_data.summary' which was not found
[0m15:44:56.521937 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.96657854, "process_in_blocks": "0", "process_kernel_time": 0.423834, "process_mem_max_rss": "107421696", "process_out_blocks": "0", "process_user_time": 2.273851}
[0m15:44:56.522604 [debug] [MainThread]: Command `dbt compile` failed at 15:44:56.522476 after 0.97 seconds
[0m15:44:56.523067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9cc80>]}
[0m15:44:56.523534 [debug] [MainThread]: Flushing usage events
[0m15:44:56.821701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:17.566158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c73a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dae3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dae3c50>]}


============================== 15:45:17.572902 | a60dd15c-9122-4b99-bced-a420982a0a84 ==============================
[0m15:45:17.572902 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:45:17.573560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:17.751391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a60dd15c-9122-4b99-bced-a420982a0a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e01dba0>]}
[0m15:45:17.812541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a60dd15c-9122-4b99-bced-a420982a0a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da75480>]}
[0m15:45:17.814083 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:45:17.926779 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:45:18.100947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:18.101810 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_sources.yml
[0m15:45:18.403523 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.stg_postgres__meter_readings' (models/staging/stg_postgres__meter_readings.sql) depends on a source named 'ekm_data.summary' which was not found
[0m15:45:18.406500 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.9249064, "process_in_blocks": "0", "process_kernel_time": 0.351887, "process_mem_max_rss": "107360256", "process_out_blocks": "0", "process_user_time": 2.188153}
[0m15:45:18.407099 [debug] [MainThread]: Command `dbt compile` failed at 15:45:18.406963 after 0.93 seconds
[0m15:45:18.407573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e914c80>]}
[0m15:45:18.407995 [debug] [MainThread]: Flushing usage events
[0m15:45:18.615464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:33.956097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a973ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a973c50>]}


============================== 15:45:33.962814 | 7d55d03c-accb-4391-b7c6-4d1d336679d8 ==============================
[0m15:45:33.962814 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:45:33.963516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:34.150787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d55d03c-accb-4391-b7c6-4d1d336679d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeb5ba0>]}
[0m15:45:34.217515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d55d03c-accb-4391-b7c6-4d1d336679d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a905480>]}
[0m15:45:34.219046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:45:34.331192 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:45:34.499228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:34.500026 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_sources.yml
[0m15:45:34.800579 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.stg_postgres__meter_readings' (models/staging/stg_postgres__meter_readings.sql) depends on a source named 'ekm_data.summary' which was not found
[0m15:45:34.802778 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.9309353, "process_in_blocks": "0", "process_kernel_time": 0.352862, "process_mem_max_rss": "107560960", "process_out_blocks": "0", "process_user_time": 2.167781}
[0m15:45:34.803320 [debug] [MainThread]: Command `dbt compile` failed at 15:45:34.803192 after 0.93 seconds
[0m15:45:34.803747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7a8c80>]}
[0m15:45:34.804157 [debug] [MainThread]: Flushing usage events
[0m15:45:35.013146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:00.636425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112467ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112467c50>]}


============================== 15:46:00.643116 | 88d72c1f-ade8-4db8-a687-7101cae5eeb9 ==============================
[0m15:46:00.643116 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:46:00.643765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:00.839332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88d72c1f-ade8-4db8-a687-7101cae5eeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129a1ba0>]}
[0m15:46:00.901661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88d72c1f-ade8-4db8-a687-7101cae5eeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123fd480>]}
[0m15:46:00.903006 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:01.017911 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:46:01.142897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:01.143355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:01.186693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88d72c1f-ade8-4db8-a687-7101cae5eeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112906f50>]}
[0m15:46:01.263324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:46:01.266706 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:46:01.298363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88d72c1f-ade8-4db8-a687-7101cae5eeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11294eb70>]}
[0m15:46:01.298918 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 433 macros
[0m15:46:01.299298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88d72c1f-ade8-4db8-a687-7101cae5eeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113296190>]}
[0m15:46:01.301454 [info ] [MainThread]: 
[0m15:46:01.301880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:01.302212 [info ] [MainThread]: 
[0m15:46:01.302758 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:01.307926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp_vtec_dbt_test'
[0m15:46:01.385101 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:46:01.385557 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:46:01.385877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:01.423770 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m15:46:01.424226 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:46:01.424560 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:46:01.433279 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m15:46:01.434765 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:46:01.435799 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:46:01.441031 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:01.441465 [debug] [MainThread]: On master: BEGIN
[0m15:46:01.441756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:01.453779 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:46:01.454248 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:01.454634 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:46:01.462268 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m15:46:01.463974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88d72c1f-ade8-4db8-a687-7101cae5eeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134872b0>]}
[0m15:46:01.464452 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:01.465469 [debug] [MainThread]: On master: Close
[0m15:46:01.469008 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:46:01.469547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.my_first_dbt_model)
[0m15:46:01.469918 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:46:01.476855 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:46:01.478172 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:46:01.478923 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:46:01.479313 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:01.479694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:46:01.480039 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:01.486814 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:46:01.487661 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:01.488462 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:01.488895 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m15:46:01.489320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now model.jaffle_shop.my_second_dbt_model)
[0m15:46:01.489751 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m15:46:01.492148 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m15:46:01.492902 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m15:46:01.493657 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m15:46:01.494125 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:01.494762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_second_dbt_model, now test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:46:01.495233 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:01.511042 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:46:01.511971 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:01.512680 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:01.513055 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:01.513413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m15:46:01.513749 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:01.519511 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:46:01.520421 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:01.521188 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:01.521569 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:01.522079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m15:46:01.522472 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:01.526201 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:46:01.527086 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:01.527892 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:01.528300 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:01.528675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:46:01.529012 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:01.533160 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:46:01.534126 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:01.534985 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:01.536185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:01.536583 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:46:01.538331 [debug] [MainThread]: Command end result
[0m15:46:01.584977 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:46:01.587479 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:46:01.598229 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:46:01.600725 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.0485122, "process_in_blocks": "0", "process_kernel_time": 0.439177, "process_mem_max_rss": "112508928", "process_out_blocks": "0", "process_user_time": 2.231549}
[0m15:46:01.601401 [debug] [MainThread]: Command `dbt compile` succeeded at 15:46:01.601246 after 1.05 seconds
[0m15:46:01.601930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11236dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136047e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113604ec0>]}
[0m15:46:01.602423 [debug] [MainThread]: Flushing usage events
[0m15:46:01.808585 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:35.637566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a697ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a697c50>]}


============================== 15:46:35.645357 | 2dcc3c7a-007c-498f-b019-d5be7a631762 ==============================
[0m15:46:35.645357 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:46:35.646097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:35.859040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dcc3c7a-007c-498f-b019-d5be7a631762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abcdba0>]}
[0m15:46:35.928522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dcc3c7a-007c-498f-b019-d5be7a631762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a625480>]}
[0m15:46:35.929776 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:36.045409 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:46:36.177043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:36.177503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:36.224085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dcc3c7a-007c-498f-b019-d5be7a631762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab32f50>]}
[0m15:46:36.308593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:46:36.313194 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:46:36.341730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dcc3c7a-007c-498f-b019-d5be7a631762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab76b70>]}
[0m15:46:36.342308 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 433 macros
[0m15:46:36.342683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dcc3c7a-007c-498f-b019-d5be7a631762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ba190>]}
[0m15:46:36.344785 [info ] [MainThread]: 
[0m15:46:36.345195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:36.345552 [info ] [MainThread]: 
[0m15:46:36.346073 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:36.351321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp_vtec_dbt_test'
[0m15:46:36.418083 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:46:36.418536 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:46:36.418960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:36.450791 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m15:46:36.451256 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:46:36.451598 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:46:36.455283 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m15:46:36.456874 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:46:36.457986 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:46:36.462906 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:36.463383 [debug] [MainThread]: On master: BEGIN
[0m15:46:36.463729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:36.476011 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:46:36.476472 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:36.476842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:46:36.480953 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:46:36.482583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dcc3c7a-007c-498f-b019-d5be7a631762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b32b0>]}
[0m15:46:36.483039 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:36.483990 [debug] [MainThread]: On master: Close
[0m15:46:36.487973 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:46:36.488636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.my_first_dbt_model)
[0m15:46:36.489077 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:46:36.496044 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:46:36.497241 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:46:36.498049 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:46:36.498448 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:36.498838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:46:36.499203 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:36.506104 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:46:36.507584 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:36.508773 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:36.509288 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m15:46:36.509731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now model.jaffle_shop.my_second_dbt_model)
[0m15:46:36.510090 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m15:46:36.512548 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m15:46:36.513295 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m15:46:36.513981 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m15:46:36.514362 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:36.514731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_second_dbt_model, now test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:46:36.515064 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:36.531443 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:46:36.532391 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:36.533130 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:36.533514 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:36.533889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m15:46:36.534241 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:36.541594 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:46:36.543014 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:36.543800 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:36.544208 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:36.544681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m15:46:36.545069 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:36.548613 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:46:36.549402 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:36.550096 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:36.550488 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:36.550860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:46:36.551194 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:36.555485 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:46:36.556348 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:36.557062 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:36.558218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:36.558551 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:46:36.560146 [debug] [MainThread]: Command end result
[0m15:46:36.578165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:46:36.580016 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:46:36.588655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:46:36.590766 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.0404384, "process_in_blocks": "0", "process_kernel_time": 0.435512, "process_mem_max_rss": "112545792", "process_out_blocks": "0", "process_user_time": 2.31635}
[0m15:46:36.591277 [debug] [MainThread]: Command `dbt compile` succeeded at 15:46:36.591164 after 1.04 seconds
[0m15:46:36.591676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a595cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83cec0>]}
[0m15:46:36.592103 [debug] [MainThread]: Flushing usage events
[0m15:46:36.887729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:48.654751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dfc50>]}


============================== 15:46:48.660441 | 463f6f27-cb75-477d-a9b3-e168226716ac ==============================
[0m15:46:48.660441 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:46:48.661291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:48.847994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '463f6f27-cb75-477d-a9b3-e168226716ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e15ba0>]}
[0m15:46:48.911380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '463f6f27-cb75-477d-a9b3-e168226716ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108871480>]}
[0m15:46:48.912351 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:49.028869 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:46:49.172156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:49.172605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:49.260073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '463f6f27-cb75-477d-a9b3-e168226716ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d66f50>]}
[0m15:46:49.359290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:46:49.363560 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:46:49.391348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '463f6f27-cb75-477d-a9b3-e168226716ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc2b70>]}
[0m15:46:49.392010 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 433 macros
[0m15:46:49.392719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463f6f27-cb75-477d-a9b3-e168226716ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109702190>]}
[0m15:46:49.395296 [info ] [MainThread]: 
[0m15:46:49.395832 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:49.396181 [info ] [MainThread]: 
[0m15:46:49.396738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:49.402372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp_vtec_dbt_test'
[0m15:46:49.470023 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:46:49.470459 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:46:49.470769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:49.500665 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m15:46:49.501124 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:46:49.501455 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:46:49.504558 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m15:46:49.506409 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:46:49.507607 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:46:49.513198 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:49.513723 [debug] [MainThread]: On master: BEGIN
[0m15:46:49.514399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:49.527760 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:46:49.528231 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:49.528691 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:46:49.533689 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:46:49.536824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463f6f27-cb75-477d-a9b3-e168226716ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fb2b0>]}
[0m15:46:49.537848 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:49.539469 [debug] [MainThread]: On master: Close
[0m15:46:49.543307 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:46:49.544205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.my_first_dbt_model)
[0m15:46:49.564030 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:46:49.572948 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:46:49.573842 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:46:49.574612 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:46:49.575009 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:49.575626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:46:49.576024 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:49.584185 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:46:49.585137 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:49.586450 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:46:49.587150 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m15:46:49.587660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now model.jaffle_shop.my_second_dbt_model)
[0m15:46:49.588042 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m15:46:49.590508 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m15:46:49.591275 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m15:46:49.591993 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m15:46:49.592391 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:49.592767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_second_dbt_model, now test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:46:49.593101 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:49.610913 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:46:49.611886 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:49.612592 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:46:49.612973 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:49.613342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m15:46:49.613687 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:49.619979 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:46:49.620830 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:49.621539 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:46:49.621999 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:49.622430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m15:46:49.622863 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:49.627251 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:46:49.628491 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:49.629283 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:46:49.629669 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:49.630046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:46:49.630399 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:49.634788 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:46:49.635882 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:49.636650 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:46:49.637720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:49.638066 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:46:49.639721 [debug] [MainThread]: Command end result
[0m15:46:49.658065 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:46:49.660020 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:46:49.669065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:46:49.671055 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.110114, "process_in_blocks": "0", "process_kernel_time": 0.351188, "process_mem_max_rss": "112943104", "process_out_blocks": "0", "process_user_time": 2.279032}
[0m15:46:49.671564 [debug] [MainThread]: Command `dbt compile` succeeded at 15:46:49.671447 after 1.11 seconds
[0m15:46:49.671957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a78890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a78ec0>]}
[0m15:46:49.672331 [debug] [MainThread]: Flushing usage events
[0m15:46:49.879432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:09.498095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d466270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7e7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7e7c50>]}


============================== 15:47:09.504579 | e1d6b594-6f66-41da-8410-61aaeadcc8df ==============================
[0m15:47:09.504579 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:47:09.505230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:47:09.696525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1d6b594-6f66-41da-8410-61aaeadcc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed21ba0>]}
[0m15:47:09.769694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1d6b594-6f66-41da-8410-61aaeadcc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e77d480>]}
[0m15:47:09.771528 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:09.956238 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:47:10.125411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:10.126350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:10.174010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1d6b594-6f66-41da-8410-61aaeadcc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec86f50>]}
[0m15:47:10.259276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:47:10.263145 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:47:10.306310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1d6b594-6f66-41da-8410-61aaeadcc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eccf110>]}
[0m15:47:10.306845 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 433 macros
[0m15:47:10.309232 [info ] [MainThread]: 
[0m15:47:10.309733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:10.310057 [info ] [MainThread]: 
[0m15:47:10.310606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:10.316012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m15:47:10.386632 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m15:47:10.387077 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m15:47:10.387407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:10.420474 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.033 seconds
[0m15:47:10.422231 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m15:47:10.423932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m15:47:10.430099 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:47:10.430519 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:47:10.430817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:10.443837 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m15:47:10.444312 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:47:10.444638 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:47:10.450492 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m15:47:10.451979 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:47:10.452996 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:47:10.457942 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:10.458356 [debug] [MainThread]: On master: BEGIN
[0m15:47:10.458646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:10.472292 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:47:10.472713 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:10.473073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:10.477972 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:47:10.479617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d6b594-6f66-41da-8410-61aaeadcc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6cfcb0>]}
[0m15:47:10.480075 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:10.481234 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:10.481648 [debug] [MainThread]: On master: BEGIN
[0m15:47:10.483299 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:47:10.483845 [debug] [MainThread]: On master: COMMIT
[0m15:47:10.484246 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:10.484543 [debug] [MainThread]: On master: COMMIT
[0m15:47:10.485642 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:47:10.486085 [debug] [MainThread]: On master: Close
[0m15:47:10.488943 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:47:10.489562 [info ] [Thread-1 (]: 1 of 7 START sql table model vtec_dbt_test.my_first_dbt_model .................. [RUN]
[0m15:47:10.490081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.my_first_dbt_model)
[0m15:47:10.490472 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:47:10.499727 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:47:10.500666 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:47:10.546336 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m15:47:10.560831 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:47:10.561510 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m15:47:10.562036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:10.579764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:47:10.580266 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:47:10.580656 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:47:10.589066 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m15:47:10.599878 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:47:10.600350 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:47:10.601939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:10.604781 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:47:10.605208 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:47:10.606578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:10.624613 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m15:47:10.625116 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:47:10.625470 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m15:47:10.630563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:47:10.636880 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model__dbt_backup"
[0m15:47:10.642432 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m15:47:10.642948 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model__dbt_backup" cascade
[0m15:47:10.655283 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:47:10.657941 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m15:47:10.660410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d6b594-6f66-41da-8410-61aaeadcc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc03450>]}
[0m15:47:10.661526 [info ] [Thread-1 (]: 1 of 7 OK created sql table model vtec_dbt_test.my_first_dbt_model ............. [[32mSELECT 2[0m in 0.17s]
[0m15:47:10.662212 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:47:10.662640 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:47:10.663103 [info ] [Thread-1 (]: 2 of 7 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m15:47:10.663882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:47:10.664528 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:47:10.673815 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:47:10.675271 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:47:10.695806 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:47:10.697023 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:47:10.697482 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m15:47:10.697818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:10.712242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m15:47:10.712724 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:47:10.713353 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_date) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_id,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m15:47:10.718327 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "start_date" does not exist
LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                   ^

[0m15:47:10.718842 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: ROLLBACK
[0m15:47:10.720364 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m15:47:10.733718 [debug] [Thread-1 (]: Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql
[0m15:47:10.734432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d6b594-6f66-41da-8410-61aaeadcc8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7cec90>]}
[0m15:47:10.735153 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model vtec_dbt_test.stg_postgres__meter_readings  [[31mERROR[0m in 0.07s]
[0m15:47:10.735779 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:47:10.736194 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:10.736565 [info ] [Thread-1 (]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:47:10.737126 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.stg_postgres__meter_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql.
[0m15:47:10.737558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:47:10.738317 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:10.754664 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:10.755616 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:10.773417 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:10.774532 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:10.775006 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:47:10.775466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:10.788898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:47:10.789384 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:10.789751 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:47:10.791479 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:47:10.794921 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:47:10.796505 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:47:10.797354 [error] [Thread-1 (]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
[0m15:47:10.798231 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:10.798745 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:47:10.799469 [debug] [Thread-4 (]: Marking all children of 'test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m15:47:10.799983 [info ] [Thread-1 (]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:47:10.800767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m15:47:10.801177 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:47:10.808790 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:10.809613 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:47:10.811865 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:10.812876 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:10.813350 [debug] [Thread-1 (]: On test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:47:10.813725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:10.832444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m15:47:10.832934 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:10.833326 [debug] [Thread-1 (]: On test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres-zoomcamp"."vtec_dbt_test"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:47:10.836105 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:47:10.838413 [debug] [Thread-1 (]: On test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:47:10.839567 [debug] [Thread-1 (]: On test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:47:10.840311 [info ] [Thread-1 (]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m15:47:10.841088 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:47:10.842381 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m15:47:10.843390 [info ] [Thread-1 (]: 5 of 7 SKIP relation vtec_dbt_test.my_second_dbt_model ......................... [[33mSKIP[0m]
[0m15:47:10.844455 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m15:47:10.845447 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m15:47:10.847433 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:47:10.848158 [info ] [Thread-1 (]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:47:10.848699 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:47:10.849210 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:47:10.849617 [debug] [Thread-4 (]: Marking all children of 'test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m15:47:10.850361 [info ] [Thread-1 (]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:47:10.851254 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:47:10.851700 [debug] [Thread-4 (]: Marking all children of 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m15:47:10.854106 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:10.855474 [debug] [MainThread]: On master: BEGIN
[0m15:47:10.856084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:10.877158 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m15:47:10.877652 [debug] [MainThread]: On master: COMMIT
[0m15:47:10.878110 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:10.878413 [debug] [MainThread]: On master: COMMIT
[0m15:47:10.879714 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:47:10.880510 [debug] [MainThread]: On master: Close
[0m15:47:10.881437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:10.881868 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:47:10.882280 [info ] [MainThread]: 
[0m15:47:10.882679 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 2 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m15:47:10.884209 [debug] [MainThread]: Command end result
[0m15:47:10.906234 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:47:10.908104 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:47:10.916913 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:47:10.917488 [info ] [MainThread]: 
[0m15:47:10.918074 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:47:10.919034 [info ] [MainThread]: 
[0m15:47:10.919764 [error] [MainThread]:   Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql
[0m15:47:10.920322 [info ] [MainThread]: 
[0m15:47:10.920880 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:47:10.921486 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:47:10.922052 [info ] [MainThread]: 
[0m15:47:10.923019 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:47:10.923933 [info ] [MainThread]: 
[0m15:47:10.924420 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:47:10.926531 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5138242, "process_in_blocks": "0", "process_kernel_time": 0.433806, "process_mem_max_rss": "117108736", "process_out_blocks": "0", "process_user_time": 2.482686}
[0m15:47:10.927104 [debug] [MainThread]: Command `dbt build` failed at 15:47:10.926974 after 1.51 seconds
[0m15:47:10.927592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a3b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb54910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5eeb70>]}
[0m15:47:10.928011 [debug] [MainThread]: Flushing usage events
[0m15:47:11.143536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:34.947234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6b2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a67ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a67c50>]}


============================== 15:47:34.954476 | 20d1d058-6d2b-48f4-85f4-628a42112aa2 ==============================
[0m15:47:34.954476 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:47:34.955122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:47:35.155724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20d1d058-6d2b-48f4-85f4-628a42112aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fa1ba0>]}
[0m15:47:35.218538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20d1d058-6d2b-48f4-85f4-628a42112aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f5480>]}
[0m15:47:35.220167 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:35.336486 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:47:35.499227 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m15:47:35.499899 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/example/my_second_dbt_model.sql
[0m15:47:35.500226 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/example/my_first_dbt_model.sql
[0m15:47:35.565159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m15:47:35.582381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20d1d058-6d2b-48f4-85f4-628a42112aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b7ec50>]}
[0m15:47:35.653550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:47:35.656967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:47:35.705252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20d1d058-6d2b-48f4-85f4-628a42112aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bc6990>]}
[0m15:47:35.705771 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m15:47:35.707732 [info ] [MainThread]: 
[0m15:47:35.708199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:35.708636 [info ] [MainThread]: 
[0m15:47:35.709242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:35.710221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m15:47:35.784498 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m15:47:35.784956 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m15:47:35.785283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:35.816094 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m15:47:35.817562 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m15:47:35.818886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m15:47:35.824512 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:47:35.824935 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:47:35.825249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:35.837165 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:47:35.837643 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:47:35.837979 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:47:35.841234 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:47:35.842663 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:47:35.843653 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:47:35.848641 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:35.849102 [debug] [MainThread]: On master: BEGIN
[0m15:47:35.849400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:35.864565 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:47:35.865026 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:35.865405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:35.869184 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:47:35.870500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d1d058-6d2b-48f4-85f4-628a42112aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a5a90>]}
[0m15:47:35.871004 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:35.872035 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:35.872432 [debug] [MainThread]: On master: BEGIN
[0m15:47:35.873688 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:47:35.874082 [debug] [MainThread]: On master: COMMIT
[0m15:47:35.874387 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:35.874656 [debug] [MainThread]: On master: COMMIT
[0m15:47:35.875421 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:35.875746 [debug] [MainThread]: On master: Close
[0m15:47:35.879211 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:47:35.879841 [info ] [Thread-1 (]: 1 of 1 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m15:47:35.880344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:47:35.880717 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:47:35.894185 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:47:35.895102 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:47:35.934900 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:47:35.935923 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:47:35.936328 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m15:47:35.936653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:35.950070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:47:35.950593 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:47:35.950972 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_date) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_id,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m15:47:35.954042 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "start_date" does not exist
LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                   ^

[0m15:47:35.954551 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: ROLLBACK
[0m15:47:35.955512 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m15:47:35.968611 [debug] [Thread-1 (]: Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql
[0m15:47:35.970825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d1d058-6d2b-48f4-85f4-628a42112aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e70a10>]}
[0m15:47:35.971551 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model vtec_dbt_test.stg_postgres__meter_readings  [[31mERROR[0m in 0.09s]
[0m15:47:35.972370 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:47:35.973087 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.stg_postgres__meter_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql.
[0m15:47:35.974646 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:35.975019 [debug] [MainThread]: On master: BEGIN
[0m15:47:35.975309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:35.988540 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:47:35.989033 [debug] [MainThread]: On master: COMMIT
[0m15:47:35.989361 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:35.989648 [debug] [MainThread]: On master: COMMIT
[0m15:47:35.990550 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:47:35.990985 [debug] [MainThread]: On master: Close
[0m15:47:35.991451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:35.991796 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m15:47:35.992113 [info ] [MainThread]: 
[0m15:47:35.992467 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m15:47:35.993290 [debug] [MainThread]: Command end result
[0m15:47:36.011885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:47:36.014735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:47:36.020611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:47:36.020978 [info ] [MainThread]: 
[0m15:47:36.021381 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:47:36.021715 [info ] [MainThread]: 
[0m15:47:36.022123 [error] [MainThread]:   Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql
[0m15:47:36.022442 [info ] [MainThread]: 
[0m15:47:36.022772 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:47:36.024957 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.16328, "process_in_blocks": "0", "process_kernel_time": 0.460668, "process_mem_max_rss": "116031488", "process_out_blocks": "0", "process_user_time": 2.247426}
[0m15:47:36.025468 [debug] [MainThread]: Command `dbt build` failed at 15:47:36.025352 after 1.16 seconds
[0m15:47:36.026048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110965cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a0b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a0b070>]}
[0m15:47:36.026471 [debug] [MainThread]: Flushing usage events
[0m15:47:36.237853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:01.036261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107072270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841fc50>]}


============================== 15:48:01.043191 | fbf4aab2-e6ee-46aa-8ff2-b13712bc65e1 ==============================
[0m15:48:01.043191 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:48:01.044131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:48:01.215687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbf4aab2-e6ee-46aa-8ff2-b13712bc65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108965ba0>]}
[0m15:48:01.274053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbf4aab2-e6ee-46aa-8ff2-b13712bc65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b5480>]}
[0m15:48:01.275521 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:01.383405 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:48:01.554767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:01.571782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:01.580905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m15:48:01.619728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbf4aab2-e6ee-46aa-8ff2-b13712bc65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853d850>]}
[0m15:48:01.692801 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:48:01.697509 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:48:01.741990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbf4aab2-e6ee-46aa-8ff2-b13712bc65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108586990>]}
[0m15:48:01.742519 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m15:48:01.744618 [info ] [MainThread]: 
[0m15:48:01.745060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:01.745498 [info ] [MainThread]: 
[0m15:48:01.746083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:01.746975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m15:48:01.812446 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m15:48:01.812937 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m15:48:01.813267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:01.843295 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.030 seconds
[0m15:48:01.844747 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m15:48:01.846051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m15:48:01.851659 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:48:01.852080 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:48:01.852373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:01.864708 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:48:01.865194 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:48:01.865534 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:48:01.870265 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:48:01.871904 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:48:01.873098 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:48:01.877440 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:01.877860 [debug] [MainThread]: On master: BEGIN
[0m15:48:01.878151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:01.890546 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:48:01.890998 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:01.891377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:01.895079 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:48:01.896513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbf4aab2-e6ee-46aa-8ff2-b13712bc65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093990f0>]}
[0m15:48:01.897001 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:01.897920 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:01.898261 [debug] [MainThread]: On master: BEGIN
[0m15:48:01.899487 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:48:01.899901 [debug] [MainThread]: On master: COMMIT
[0m15:48:01.900208 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:01.900476 [debug] [MainThread]: On master: COMMIT
[0m15:48:01.901241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:01.901618 [debug] [MainThread]: On master: Close
[0m15:48:01.904714 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:48:01.905310 [info ] [Thread-1 (]: 1 of 1 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m15:48:01.905805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:48:01.906166 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:48:01.919570 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:01.920494 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:48:01.961141 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:01.962131 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:01.962583 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m15:48:01.962970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:01.975302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:48:01.975781 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:01.976155 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_date) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_id,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m15:48:01.977715 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "start_date" does not exist
LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                   ^

[0m15:48:01.978200 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: ROLLBACK
[0m15:48:01.979278 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m15:48:01.990050 [debug] [Thread-1 (]: Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql
[0m15:48:01.992077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbf4aab2-e6ee-46aa-8ff2-b13712bc65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fbad0>]}
[0m15:48:01.992778 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model vtec_dbt_test.stg_postgres__meter_readings  [[31mERROR[0m in 0.08s]
[0m15:48:01.993401 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:48:01.994032 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.stg_postgres__meter_readings' to be skipped because of status 'error'.  Reason: Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql.
[0m15:48:01.995531 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:01.995880 [debug] [MainThread]: On master: BEGIN
[0m15:48:01.996156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:02.010715 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:48:02.011207 [debug] [MainThread]: On master: COMMIT
[0m15:48:02.011521 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:02.011826 [debug] [MainThread]: On master: COMMIT
[0m15:48:02.012932 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:48:02.013632 [debug] [MainThread]: On master: Close
[0m15:48:02.014257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:02.014657 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m15:48:02.015029 [info ] [MainThread]: 
[0m15:48:02.015535 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m15:48:02.016505 [debug] [MainThread]: Command end result
[0m15:48:02.035400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:48:02.037059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:48:02.044173 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:48:02.044664 [info ] [MainThread]: 
[0m15:48:02.045255 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:48:02.046102 [info ] [MainThread]: 
[0m15:48:02.046754 [error] [MainThread]:   Database Error in model stg_postgres__meter_readings (models/staging/stg_postgres__meter_readings.sql)
  column "start_date" does not exist
  LINE 13:     row_number() over(partition by meter, start_date) as rn
                                                     ^
  compiled code at target/run/jaffle_shop/models/staging/stg_postgres__meter_readings.sql
[0m15:48:02.047128 [info ] [MainThread]: 
[0m15:48:02.047483 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:48:02.049497 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.0927598, "process_in_blocks": "0", "process_kernel_time": 0.318099, "process_mem_max_rss": "116187136", "process_out_blocks": "0", "process_user_time": 2.109342}
[0m15:48:02.049997 [debug] [MainThread]: Command `dbt build` failed at 15:48:02.049883 after 1.09 seconds
[0m15:48:02.050406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108325cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093de780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ddff0>]}
[0m15:48:02.051365 [debug] [MainThread]: Flushing usage events
[0m15:48:02.333904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:17.085982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eefed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eefc50>]}


============================== 15:48:17.091122 | b5bdc190-4636-4141-9746-191a88560430 ==============================
[0m15:48:17.091122 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:48:17.091767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:17.270336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5bdc190-4636-4141-9746-191a88560430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109425ba0>]}
[0m15:48:17.334613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5bdc190-4636-4141-9746-191a88560430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e81480>]}
[0m15:48:17.335583 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:17.441851 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:48:17.603274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:17.603724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:17.610189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m15:48:17.649207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5bdc190-4636-4141-9746-191a88560430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109389850>]}
[0m15:48:17.719390 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:48:17.723221 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:48:17.770411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5bdc190-4636-4141-9746-191a88560430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d2990>]}
[0m15:48:17.770961 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m15:48:17.773007 [info ] [MainThread]: 
[0m15:48:17.773424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:17.773744 [info ] [MainThread]: 
[0m15:48:17.774429 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:17.775365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m15:48:17.841173 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m15:48:17.841605 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m15:48:17.841939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:17.872531 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m15:48:17.873988 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m15:48:17.875338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m15:48:17.881316 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:48:17.881738 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:48:17.882069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:17.894025 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:48:17.894481 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:48:17.894821 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:48:17.899994 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m15:48:17.901748 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:48:17.904928 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:48:17.918257 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:17.918976 [debug] [MainThread]: On master: BEGIN
[0m15:48:17.919516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:17.939432 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m15:48:17.940264 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:17.941273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:17.951363 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:48:17.954569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5bdc190-4636-4141-9746-191a88560430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5d0f0>]}
[0m15:48:17.955697 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:17.957071 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:17.957488 [debug] [MainThread]: On master: BEGIN
[0m15:48:17.959082 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:48:17.959701 [debug] [MainThread]: On master: COMMIT
[0m15:48:17.960207 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:17.960623 [debug] [MainThread]: On master: COMMIT
[0m15:48:17.961835 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:48:17.962346 [debug] [MainThread]: On master: Close
[0m15:48:17.972172 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:48:17.973941 [info ] [Thread-1 (]: 1 of 1 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m15:48:17.974623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:48:17.975578 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:48:18.008785 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:18.010123 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:48:18.058016 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:18.058993 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:18.059380 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m15:48:18.059729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:18.071846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:48:18.072339 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:18.072714 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_id,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m15:48:18.079722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m15:48:18.086185 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:18.100679 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m15:48:18.105621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:48:18.135579 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m15:48:18.136477 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:18.137018 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m15:48:18.140755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:48:18.148099 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m15:48:18.153832 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:48:18.154339 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m15:48:18.156546 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:48:18.159264 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m15:48:18.161733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5bdc190-4636-4141-9746-191a88560430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f5570>]}
[0m15:48:18.162661 [info ] [Thread-1 (]: 1 of 1 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.19s]
[0m15:48:18.163337 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:48:18.164717 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:18.165082 [debug] [MainThread]: On master: BEGIN
[0m15:48:18.165366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:18.179559 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:48:18.180027 [debug] [MainThread]: On master: COMMIT
[0m15:48:18.180367 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:18.180661 [debug] [MainThread]: On master: COMMIT
[0m15:48:18.181531 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:48:18.181892 [debug] [MainThread]: On master: Close
[0m15:48:18.182345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:18.182659 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m15:48:18.182989 [info ] [MainThread]: 
[0m15:48:18.183382 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:48:18.184375 [debug] [MainThread]: Command end result
[0m15:48:18.202287 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:48:18.204513 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:48:18.213818 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:48:18.214214 [info ] [MainThread]: 
[0m15:48:18.214781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:18.215123 [info ] [MainThread]: 
[0m15:48:18.215488 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:48:18.217626 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2133341, "process_in_blocks": "0", "process_kernel_time": 0.318686, "process_mem_max_rss": "115834880", "process_out_blocks": "0", "process_user_time": 2.190994}
[0m15:48:18.218561 [debug] [MainThread]: Command `dbt build` succeeded at 15:48:18.218277 after 1.21 seconds
[0m15:48:18.219081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9e0a0>]}
[0m15:48:18.219487 [debug] [MainThread]: Flushing usage events
[0m15:48:18.451639 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:55.973639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b66270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f1bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f1bc50>]}


============================== 15:57:55.981864 | 5c6ec44a-a87c-4b94-b808-6d3f569edbb7 ==============================
[0m15:57:55.981864 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:57:55.982662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:57:56.188182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c6ec44a-a87c-4b94-b808-6d3f569edbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112459ba0>]}
[0m15:57:56.248348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c6ec44a-a87c-4b94-b808-6d3f569edbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea9480>]}
[0m15:57:56.249840 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:57:56.363139 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:57:56.513283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:56.513727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:56.519212 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m15:57:56.554303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c6ec44a-a87c-4b94-b808-6d3f569edbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112031850>]}
[0m15:57:56.650282 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:57:56.654087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:57:56.684676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c6ec44a-a87c-4b94-b808-6d3f569edbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120797c0>]}
[0m15:57:56.685371 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m15:57:56.685770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6ec44a-a87c-4b94-b808-6d3f569edbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d19c50>]}
[0m15:57:56.688303 [info ] [MainThread]: 
[0m15:57:56.688742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:56.689053 [info ] [MainThread]: 
[0m15:57:56.689645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:56.691256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp_vtec_dbt_test'
[0m15:57:56.764237 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:57:56.764765 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:57:56.765872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:56.803856 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m15:57:56.804313 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:57:56.804638 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:57:56.808791 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m15:57:56.810322 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:57:56.811576 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:57:56.816242 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:56.816666 [debug] [MainThread]: On master: BEGIN
[0m15:57:56.816960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:56.828924 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:57:56.829523 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:56.830115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:56.835331 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m15:57:56.836686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6ec44a-a87c-4b94-b808-6d3f569edbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f65a50>]}
[0m15:57:56.837137 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:56.838073 [debug] [MainThread]: On master: Close
[0m15:57:56.841591 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:57:56.842170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:57:56.842554 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:57:56.853757 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:57:56.854622 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:57:56.855368 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:57:56.856500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:56.856850 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m15:57:56.857501 [debug] [MainThread]: Command end result
[0m15:57:56.875733 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:57:56.877453 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:57:56.884144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:57:56.886294 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.0416428, "process_in_blocks": "0", "process_kernel_time": 0.44807, "process_mem_max_rss": "112459776", "process_out_blocks": "0", "process_user_time": 2.135433}
[0m15:57:56.886816 [debug] [MainThread]: Command `dbt compile` succeeded at 15:57:56.886699 after 1.04 seconds
[0m15:57:56.887212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e19cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2b800>]}
[0m15:57:56.887587 [debug] [MainThread]: Flushing usage events
[0m15:57:57.164614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:38.968613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aba270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6fc50>]}


============================== 15:58:38.975649 | 73dcf902-5019-4742-9334-6846ad20ea15 ==============================
[0m15:58:38.975649 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:58:38.976322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:39.177946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73dcf902-5019-4742-9334-6846ad20ea15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a9ba0>]}
[0m15:58:39.259275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73dcf902-5019-4742-9334-6846ad20ea15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dfd480>]}
[0m15:58:39.261570 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:58:39.402804 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:58:39.511960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:39.512408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:39.547030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73dcf902-5019-4742-9334-6846ad20ea15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f71850>]}
[0m15:58:39.613914 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:58:39.617627 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:58:39.646302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73dcf902-5019-4742-9334-6846ad20ea15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcd7c0>]}
[0m15:58:39.646834 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m15:58:39.647198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73dcf902-5019-4742-9334-6846ad20ea15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c45c50>]}
[0m15:58:39.649668 [info ] [MainThread]: 
[0m15:58:39.650095 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:39.650409 [info ] [MainThread]: 
[0m15:58:39.650942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:39.651772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp_vtec_dbt_test'
[0m15:58:39.719177 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:58:39.719650 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:58:39.719988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:39.753915 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m15:58:39.754374 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:58:39.754720 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:58:39.759390 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m15:58:39.760866 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:58:39.761926 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:58:39.766504 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:39.766917 [debug] [MainThread]: On master: BEGIN
[0m15:58:39.767231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:39.778817 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:58:39.779273 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:39.779636 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:39.783441 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m15:58:39.784752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73dcf902-5019-4742-9334-6846ad20ea15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea1a50>]}
[0m15:58:39.785220 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:39.786075 [debug] [MainThread]: On master: Close
[0m15:58:39.789653 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:58:39.790385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:58:39.791139 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:58:39.802334 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:39.803761 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:58:39.804574 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:58:39.805657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:39.806025 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m15:58:39.806676 [debug] [MainThread]: Command end result
[0m15:58:39.824701 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:58:39.826649 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:58:39.833765 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:58:39.835888 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.9510971, "process_in_blocks": "0", "process_kernel_time": 0.399046, "process_mem_max_rss": "111411200", "process_out_blocks": "0", "process_user_time": 2.10106}
[0m15:58:39.836415 [debug] [MainThread]: Command `dbt compile` succeeded at 15:58:39.836296 after 0.95 seconds
[0m15:58:39.836814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c6b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c6b800>]}
[0m15:58:39.837180 [debug] [MainThread]: Flushing usage events
[0m15:58:40.050948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:50.132852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a9e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4fc50>]}


============================== 15:58:50.138894 | eebdc097-0610-447e-8e1a-ea1b4e496ba9 ==============================
[0m15:58:50.138894 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:58:50.139551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:50.331509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eebdc097-0610-447e-8e1a-ea1b4e496ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a385ba0>]}
[0m15:58:50.393648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eebdc097-0610-447e-8e1a-ea1b4e496ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddd480>]}
[0m15:58:50.395213 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:58:50.508353 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:58:50.655080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:50.655526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:50.689109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eebdc097-0610-447e-8e1a-ea1b4e496ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ed850>]}
[0m15:58:50.755394 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:58:50.759039 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:58:50.803727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eebdc097-0610-447e-8e1a-ea1b4e496ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a332990>]}
[0m15:58:50.804235 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m15:58:50.806230 [info ] [MainThread]: 
[0m15:58:50.806649 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:50.806985 [info ] [MainThread]: 
[0m15:58:50.807523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:50.808407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m15:58:50.876488 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m15:58:50.876919 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m15:58:50.877243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:50.906939 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.030 seconds
[0m15:58:50.908409 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m15:58:50.909702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m15:58:50.915382 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:58:50.915804 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m15:58:50.916103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:50.927908 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:58:50.928396 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m15:58:50.928718 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m15:58:50.933464 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m15:58:50.934926 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m15:58:50.935911 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m15:58:50.940438 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:50.940849 [debug] [MainThread]: On master: BEGIN
[0m15:58:50.941133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:50.953673 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:58:50.954133 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:50.954507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:50.959132 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:58:50.960428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eebdc097-0610-447e-8e1a-ea1b4e496ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adbcbb0>]}
[0m15:58:50.960975 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:50.961876 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:50.962225 [debug] [MainThread]: On master: BEGIN
[0m15:58:50.963330 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:58:50.963764 [debug] [MainThread]: On master: COMMIT
[0m15:58:50.964078 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:50.964370 [debug] [MainThread]: On master: COMMIT
[0m15:58:50.965079 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:58:50.965470 [debug] [MainThread]: On master: Close
[0m15:58:50.968577 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:58:50.969202 [info ] [Thread-1 (]: 1 of 1 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m15:58:50.969733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m15:58:50.970120 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m15:58:50.982701 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:50.984426 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m15:58:51.025062 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:51.026745 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:51.027181 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m15:58:51.027510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:51.040357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:58:51.040858 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:51.041249 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_id,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m15:58:51.046919 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:58:51.053441 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:51.066682 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m15:58:51.068907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:51.072185 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:51.073069 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m15:58:51.074600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:51.091554 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m15:58:51.092097 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:51.092468 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m15:58:51.096855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:58:51.103082 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m15:58:51.108331 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m15:58:51.108738 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m15:58:51.113310 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:58:51.116503 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m15:58:51.119389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdc097-0610-447e-8e1a-ea1b4e496ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b25db20>]}
[0m15:58:51.120478 [info ] [Thread-1 (]: 1 of 1 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.15s]
[0m15:58:51.121186 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m15:58:51.122532 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:51.123072 [debug] [MainThread]: On master: BEGIN
[0m15:58:51.123374 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:51.138571 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:58:51.139043 [debug] [MainThread]: On master: COMMIT
[0m15:58:51.139377 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:51.139671 [debug] [MainThread]: On master: COMMIT
[0m15:58:51.140531 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:58:51.140936 [debug] [MainThread]: On master: Close
[0m15:58:51.141407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:51.141740 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m15:58:51.142058 [info ] [MainThread]: 
[0m15:58:51.142507 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:58:51.143571 [debug] [MainThread]: Command end result
[0m15:58:51.162941 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m15:58:51.164593 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m15:58:51.173102 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m15:58:51.173687 [info ] [MainThread]: 
[0m15:58:51.174418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:51.174917 [info ] [MainThread]: 
[0m15:58:51.175310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:58:51.177337 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.1256622, "process_in_blocks": "0", "process_kernel_time": 0.344775, "process_mem_max_rss": "115879936", "process_out_blocks": "0", "process_user_time": 2.176125}
[0m15:58:51.177828 [debug] [MainThread]: Command `dbt build` succeeded at 15:58:51.177709 after 1.13 seconds
[0m15:58:51.178218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d4dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf60a0>]}
[0m15:58:51.178588 [debug] [MainThread]: Flushing usage events
[0m15:58:51.389973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:45.649429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083fe270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097afed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097afc50>]}


============================== 16:01:45.656228 | e2af41f1-bbe9-4e11-a0c8-b2ed9d288284 ==============================
[0m16:01:45.656228 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:01:45.656892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:01:45.864979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2af41f1-bbe9-4e11-a0c8-b2ed9d288284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce5ba0>]}
[0m16:01:45.929878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2af41f1-bbe9-4e11-a0c8-b2ed9d288284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973d480>]}
[0m16:01:45.931415 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:01:46.047250 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:01:46.173616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:46.174091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:46.219746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2af41f1-bbe9-4e11-a0c8-b2ed9d288284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c48850>]}
[0m16:01:46.296927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:01:46.300755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:01:46.355150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2af41f1-bbe9-4e11-a0c8-b2ed9d288284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8e990>]}
[0m16:01:46.355754 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 433 macros
[0m16:01:46.358237 [info ] [MainThread]: 
[0m16:01:46.358715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:46.359101 [info ] [MainThread]: 
[0m16:01:46.359633 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:46.365324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:01:46.511040 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:01:46.511476 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:01:46.511808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:46.548292 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.036 seconds
[0m16:01:46.559831 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:01:46.561555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:01:46.567506 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:01:46.567939 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:01:46.568243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:46.581817 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:01:46.582280 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:01:46.582622 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:01:46.586300 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m16:01:46.587911 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:01:46.589075 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:01:46.594115 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:46.594561 [debug] [MainThread]: On master: BEGIN
[0m16:01:46.594857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:46.607725 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:01:46.608186 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:46.608577 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:46.613931 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:01:46.615619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2af41f1-bbe9-4e11-a0c8-b2ed9d288284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a67bd90>]}
[0m16:01:46.616464 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:46.617900 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:46.618538 [debug] [MainThread]: On master: BEGIN
[0m16:01:46.620590 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:01:46.621428 [debug] [MainThread]: On master: COMMIT
[0m16:01:46.621879 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:46.622331 [debug] [MainThread]: On master: COMMIT
[0m16:01:46.623412 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:01:46.623841 [debug] [MainThread]: On master: Close
[0m16:01:46.627618 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:01:46.628288 [info ] [Thread-1 (]: 1 of 3 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:01:46.628833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:01:46.629231 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:01:46.644809 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:01:46.646229 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:01:46.690041 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:01:46.691660 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:01:46.692077 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:01:46.692414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:46.705881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:01:46.706450 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:01:46.706891 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_id,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:01:46.710695 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:01:46.716850 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:01:46.717288 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:01:46.718893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:46.721709 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:01:46.722512 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:01:46.723997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:46.740744 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:01:46.741259 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:01:46.741629 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:01:46.745756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:46.752209 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:01:46.757576 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:01:46.758030 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:01:46.762499 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:01:46.765107 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:01:46.767392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2af41f1-bbe9-4e11-a0c8-b2ed9d288284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abce0d0>]}
[0m16:01:46.768269 [info ] [Thread-1 (]: 1 of 3 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.14s]
[0m16:01:46.769007 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:01:46.769446 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:01:46.770041 [info ] [Thread-1 (]: 2 of 3 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:01:46.770570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:01:46.770942 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:01:46.771298 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:01:46.802270 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:01:46.802798 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:01:46.803159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:46.814877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:01:46.815419 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:01:46.815772 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */

    create table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key" text,"meter_address" integer,"name" text)
  
[0m16:01:46.821225 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m16:01:46.839807 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:01:46.840294 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:01:46.843005 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.002 seconds
[0m16:01:46.848613 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:01:46.854607 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:01:46.855067 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:01:46.855419 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:01:46.859516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:46.860428 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:01:46.861120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2af41f1-bbe9-4e11-a0c8-b2ed9d288284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a75b290>]}
[0m16:01:46.861756 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.09s]
[0m16:01:46.862597 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:01:46.863632 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:01:46.864259 [info ] [Thread-1 (]: 3 of 3 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:01:46.864773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:01:46.865138 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:01:46.868708 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:01:46.869825 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:01:46.895143 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:01:46.896256 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:01:46.896662 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:01:46.896992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:46.909270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:01:46.909772 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:01:46.910141 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    meter_address, 
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:01:46.912584 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m16:01:46.915877 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:01:46.916369 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:01:46.917859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:46.919437 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:01:46.919873 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:01:46.920354 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:01:46.924109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:01:46.926365 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:01:46.929279 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:01:46.929695 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:01:46.931084 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:01:46.932648 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:01:46.933298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2af41f1-bbe9-4e11-a0c8-b2ed9d288284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73b8b0>]}
[0m16:01:46.933999 [info ] [Thread-1 (]: 3 of 3 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.07s]
[0m16:01:46.934692 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:01:46.936098 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:46.936506 [debug] [MainThread]: On master: BEGIN
[0m16:01:46.936805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:46.950133 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:01:46.950694 [debug] [MainThread]: On master: COMMIT
[0m16:01:46.951134 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:46.951718 [debug] [MainThread]: On master: COMMIT
[0m16:01:46.952822 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:01:46.953256 [debug] [MainThread]: On master: Close
[0m16:01:46.953766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:46.954080 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_meters' was properly closed.
[0m16:01:46.954430 [info ] [MainThread]: 
[0m16:01:46.954809 [info ] [MainThread]: Finished running 1 seed, 1 table model, 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:01:46.955989 [debug] [MainThread]: Command end result
[0m16:01:46.975950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:01:46.977632 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:01:46.984995 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:01:46.985764 [info ] [MainThread]: 
[0m16:01:46.986393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:46.986735 [info ] [MainThread]: 
[0m16:01:46.987079 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:01:46.989069 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.422553, "process_in_blocks": "0", "process_kernel_time": 0.453291, "process_mem_max_rss": "116518912", "process_out_blocks": "0", "process_user_time": 2.40224}
[0m16:01:46.989698 [debug] [MainThread]: Command `dbt build` succeeded at 16:01:46.989557 after 1.42 seconds
[0m16:01:46.990117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abfe490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7cb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac35d0>]}
[0m16:01:46.990511 [debug] [MainThread]: Flushing usage events
[0m16:01:47.282172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:20.517959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918bc50>]}


============================== 16:11:20.524965 | 49cbcaa7-516f-4dfa-bf58-0227441fd1fd ==============================
[0m16:11:20.524965 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:11:20.525634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:11:20.773036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49cbcaa7-516f-4dfa-bf58-0227441fd1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c9ba0>]}
[0m16:11:20.835330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49cbcaa7-516f-4dfa-bf58-0227441fd1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109119480>]}
[0m16:11:20.836857 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:11:20.950940 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:11:21.074907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:21.075324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:21.120941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49cbcaa7-516f-4dfa-bf58-0227441fd1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928c850>]}
[0m16:11:21.226675 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:11:21.230397 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:11:21.259385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49cbcaa7-516f-4dfa-bf58-0227441fd1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e97c0>]}
[0m16:11:21.259937 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:11:21.260308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49cbcaa7-516f-4dfa-bf58-0227441fd1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb19b0>]}
[0m16:11:21.262309 [info ] [MainThread]: 
[0m16:11:21.262716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:21.263023 [info ] [MainThread]: 
[0m16:11:21.263759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:21.268941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp_vtec_dbt_test'
[0m16:11:21.344707 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:11:21.345171 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:11:21.345492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:21.380687 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m16:11:21.381147 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:11:21.381548 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:11:21.394030 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m16:11:21.395616 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:11:21.396558 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:11:21.401788 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:21.402226 [debug] [MainThread]: On master: BEGIN
[0m16:11:21.402535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:21.414498 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:11:21.414940 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:21.415299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:21.420743 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:11:21.422076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49cbcaa7-516f-4dfa-bf58-0227441fd1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ca0d0>]}
[0m16:11:21.422533 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:21.423496 [debug] [MainThread]: On master: Close
[0m16:11:21.426812 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:21.427384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:11:21.427777 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:21.438822 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:21.440828 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:21.441668 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:21.442080 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:11:21.442476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:11:21.442819 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:11:21.444363 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:11:21.445046 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:11:21.445813 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:11:21.446224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:11:21.446579 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:11:21.449005 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:11:21.450141 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:11:21.450892 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:11:21.451557 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:11:21.451988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:11:21.452351 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:11:21.455088 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:11:21.456217 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:11:21.456962 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:11:21.457842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:21.458160 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:11:21.459184 [debug] [MainThread]: Command end result
[0m16:11:21.478670 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:11:21.480681 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:11:21.488273 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:11:21.490426 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.0712945, "process_in_blocks": "0", "process_kernel_time": 0.443502, "process_mem_max_rss": "112578560", "process_out_blocks": "0", "process_user_time": 2.169993}
[0m16:11:21.490924 [debug] [MainThread]: Command `dbt compile` succeeded at 16:11:21.490809 after 1.07 seconds
[0m16:11:21.491308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109089cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f85d0>]}
[0m16:11:21.491742 [debug] [MainThread]: Flushing usage events
[0m16:11:21.775485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:25.529143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104293ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104293c50>]}


============================== 16:11:25.534219 | 154d639d-ef95-4e16-bb2a-587008cdf3ab ==============================
[0m16:11:25.534219 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:11:25.534966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:25.713051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c9ba0>]}
[0m16:11:25.773204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104221480>]}
[0m16:11:25.774246 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:11:25.875450 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:11:26.008333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:26.008781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:26.053459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104734850>]}
[0m16:11:26.132034 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:11:26.135402 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:11:26.169259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104772990>]}
[0m16:11:26.169844 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:11:26.172124 [info ] [MainThread]: 
[0m16:11:26.172546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:26.172862 [info ] [MainThread]: 
[0m16:11:26.173407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:26.178412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:11:26.244116 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:11:26.244582 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:11:26.244927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:26.277027 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.032 seconds
[0m16:11:26.278503 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:11:26.280098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:11:26.285989 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:11:26.286442 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:11:26.286777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:26.299676 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:11:26.300139 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:11:26.300463 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:11:26.304965 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m16:11:26.306436 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:11:26.308592 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:11:26.313947 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:26.314407 [debug] [MainThread]: On master: BEGIN
[0m16:11:26.314707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:26.325743 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:11:26.326229 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:26.326604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:26.331409 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m16:11:26.332756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105163d90>]}
[0m16:11:26.333232 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:26.334121 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:26.334524 [debug] [MainThread]: On master: BEGIN
[0m16:11:26.335723 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:11:26.336090 [debug] [MainThread]: On master: COMMIT
[0m16:11:26.336383 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:26.336647 [debug] [MainThread]: On master: COMMIT
[0m16:11:26.337980 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:26.338340 [debug] [MainThread]: On master: Close
[0m16:11:26.340571 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:26.341277 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:11:26.341815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:11:26.342195 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:26.382202 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:26.414886 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:26.459275 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:26.461453 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:26.461851 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:11:26.462168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:26.475054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:11:26.475556 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:26.475942 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:11:26.480457 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:11:26.486312 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:26.486726 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:11:26.488306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:26.491488 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:26.492371 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:11:26.493888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:26.510570 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:11:26.511078 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:26.511440 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:11:26.535665 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m16:11:26.548289 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:11:26.555988 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:26.556603 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:11:26.563612 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m16:11:26.566902 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:11:26.569426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b60d0>]}
[0m16:11:26.570520 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.23s]
[0m16:11:26.571329 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:26.571813 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:11:26.572452 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:11:26.573017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:11:26.573533 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:11:26.574065 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:11:26.607014 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:11:26.607569 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:11:26.607931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:26.622259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:11:26.622792 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:11:26.623174 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:11:26.626270 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m16:11:26.643461 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:11:26.643958 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:11:26.645548 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:11:26.651729 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:11:26.653987 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:11:26.654439 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:11:26.654777 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:11:26.658690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:11:26.659597 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:11:26.660274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105247110>]}
[0m16:11:26.660927 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.09s]
[0m16:11:26.661572 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:11:26.662503 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:11:26.663199 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:11:26.663755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:11:26.664123 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:11:26.666750 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:11:26.667597 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:11:26.693711 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:11:26.694658 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:26.695041 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:11:26.695370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:26.708407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:11:26.708928 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:26.709308 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    meter_address, 
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:11:26.716320 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m16:11:26.723486 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:26.723921 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:11:26.725403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:26.728340 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:26.728750 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:11:26.730024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:26.731651 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:11:26.732028 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:26.732363 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:11:26.735872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:11:26.738649 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:11:26.741626 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:26.742025 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:11:26.746937 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:11:26.748556 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:11:26.749176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bf3e0>]}
[0m16:11:26.749954 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.09s]
[0m16:11:26.750760 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:11:26.751823 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:11:26.752437 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:11:26.752930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:11:26.753299 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:11:26.756143 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:11:26.757760 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:11:26.763615 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:11:26.764884 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:11:26.765316 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:11:26.765654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:26.778980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:11:26.779492 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:11:26.779879 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    meter_key,
    dim_meters.name as meter_name,
    meter_type,
    start_date_time,
    end_date_time,
    total_usage_kwh
from readings_unioned
inner join dim_meters
on readings_unioned.meter_key = dim_meters.meter_key
where meter_type = 'EKM'
  );
  
[0m16:11:26.782164 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "readings_unioned" does not exist
LINE 30: from readings_unioned
              ^

[0m16:11:26.782666 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: ROLLBACK
[0m16:11:26.783758 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:11:26.797989 [debug] [Thread-1 (]: Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  relation "readings_unioned" does not exist
  LINE 30: from readings_unioned
                ^
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql
[0m16:11:26.798617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154d639d-ef95-4e16-bb2a-587008cdf3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c74d0>]}
[0m16:11:26.799351 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model vtec_dbt_test.fact_meter_readings ........ [[31mERROR[0m in 0.05s]
[0m16:11:26.800011 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:11:26.800604 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.fact_meter_readings' to be skipped because of status 'error'.  Reason: Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  relation "readings_unioned" does not exist
  LINE 30: from readings_unioned
                ^
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql.
[0m16:11:26.802117 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:26.802484 [debug] [MainThread]: On master: BEGIN
[0m16:11:26.802774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:26.816160 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:11:26.816697 [debug] [MainThread]: On master: COMMIT
[0m16:11:26.817066 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:26.817402 [debug] [MainThread]: On master: COMMIT
[0m16:11:26.818431 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:26.819311 [debug] [MainThread]: On master: Close
[0m16:11:26.819982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:26.820481 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:11:26.821039 [info ] [MainThread]: 
[0m16:11:26.821606 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m16:11:26.823079 [debug] [MainThread]: Command end result
[0m16:11:26.842781 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:11:26.845862 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:11:26.852076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:11:26.852468 [info ] [MainThread]: 
[0m16:11:26.852847 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:11:26.853321 [info ] [MainThread]: 
[0m16:11:26.853753 [error] [MainThread]:   Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  relation "readings_unioned" does not exist
  LINE 30: from readings_unioned
                ^
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql
[0m16:11:26.854078 [info ] [MainThread]: 
[0m16:11:26.854419 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:11:26.856217 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4079053, "process_in_blocks": "0", "process_kernel_time": 0.326926, "process_mem_max_rss": "117583872", "process_out_blocks": "0", "process_user_time": 2.380856}
[0m16:11:26.856999 [debug] [MainThread]: Command `dbt build` failed at 16:11:26.856823 after 1.41 seconds
[0m16:11:26.857487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d20b0>]}
[0m16:11:26.857867 [debug] [MainThread]: Flushing usage events
[0m16:11:27.107187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:45.498003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105997ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105997c50>]}


============================== 16:11:45.505184 | 5aa982a4-3ae4-472a-813c-e8e67ae8a533 ==============================
[0m16:11:45.505184 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:11:45.505961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:11:45.744419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecdba0>]}
[0m16:11:45.807355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105925480>]}
[0m16:11:45.808749 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:11:45.919191 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:11:46.041885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:46.042334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:46.086350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34850>]}
[0m16:11:46.162728 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:11:46.166275 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:11:46.212786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e76990>]}
[0m16:11:46.213375 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:11:46.215735 [info ] [MainThread]: 
[0m16:11:46.216183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:46.216494 [info ] [MainThread]: 
[0m16:11:46.217021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:46.222508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:11:46.289626 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:11:46.290074 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:11:46.290411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:46.322510 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.032 seconds
[0m16:11:46.324006 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:11:46.325533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:11:46.331412 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:11:46.331865 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:11:46.332183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:46.345537 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:11:46.345989 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:11:46.346322 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:11:46.349789 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m16:11:46.351285 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:11:46.352264 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:11:46.358088 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:46.358534 [debug] [MainThread]: On master: BEGIN
[0m16:11:46.358844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:46.370906 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:11:46.371353 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:46.371721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:46.377207 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:11:46.378566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106867d90>]}
[0m16:11:46.379043 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:46.380118 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:46.380512 [debug] [MainThread]: On master: BEGIN
[0m16:11:46.381701 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:11:46.382080 [debug] [MainThread]: On master: COMMIT
[0m16:11:46.382399 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:46.382674 [debug] [MainThread]: On master: COMMIT
[0m16:11:46.383464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:46.383835 [debug] [MainThread]: On master: Close
[0m16:11:46.386973 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:46.387594 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:11:46.388101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:11:46.388491 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:46.403132 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:46.404025 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:46.441731 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:46.442740 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:46.443218 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:11:46.443551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:46.456113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:11:46.456602 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:46.456992 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:11:46.459892 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:46.466137 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:46.466602 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:11:46.468171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:46.470962 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:46.471773 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:11:46.473115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:46.490216 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:11:46.490709 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:46.491063 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:11:46.515536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m16:11:46.525073 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:11:46.531890 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:11:46.532424 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:11:46.537991 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:11:46.540899 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:11:46.543199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db60d0>]}
[0m16:11:46.544138 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.15s]
[0m16:11:46.544814 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:11:46.545253 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:11:46.545814 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:11:46.546283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:11:46.546631 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:11:46.546985 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:11:46.578311 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:11:46.578806 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:11:46.579159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:46.592015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:11:46.592521 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:11:46.592895 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:11:46.594802 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:11:46.612157 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:11:46.612644 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:11:46.614321 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:11:46.621316 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:11:46.623341 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:11:46.623753 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:11:46.624097 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:11:46.628026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:11:46.628956 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:11:46.629561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694b110>]}
[0m16:11:46.630215 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.08s]
[0m16:11:46.630934 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:11:46.632124 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:11:46.632946 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:11:46.633559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:11:46.633977 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:11:46.637170 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:11:46.638233 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:11:46.663778 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:11:46.664762 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:46.665171 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:11:46.665488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:46.677647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:11:46.678168 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:46.678569 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    meter_address, 
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:11:46.681413 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m16:11:46.687926 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:46.688351 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:11:46.690050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:46.692941 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:46.693357 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:11:46.694862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:46.696658 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:11:46.697088 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:46.697445 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:11:46.701185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:11:46.703815 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:11:46.706781 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:11:46.707187 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:11:46.714724 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m16:11:46.716274 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:11:46.716882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c73e0>]}
[0m16:11:46.717582 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:11:46.718230 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:11:46.719053 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:11:46.719677 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:11:46.720168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:11:46.720529 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:11:46.724235 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:11:46.725607 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:11:46.730262 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:11:46.731458 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:11:46.731913 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:11:46.732258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:46.744745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:11:46.745705 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:11:46.746821 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    meter_key,
    dim_meters.name as meter_name,
    meter_type,
    start_date_time,
    end_date_time,
    total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_key = dim_meters.meter_key
where meter_type = 'EKM'
  );
  
[0m16:11:46.749414 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column ekm_meter_readings.meter_key does not exist
LINE 32: on ekm_meter_readings.meter_key = dim_meters.meter_key
            ^

[0m16:11:46.749965 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: ROLLBACK
[0m16:11:46.751055 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:11:46.763821 [debug] [Thread-1 (]: Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  column ekm_meter_readings.meter_key does not exist
  LINE 32: on ekm_meter_readings.meter_key = dim_meters.meter_key
              ^
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql
[0m16:11:46.764416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa982a4-3ae4-472a-813c-e8e67ae8a533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de74d0>]}
[0m16:11:46.765073 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model vtec_dbt_test.fact_meter_readings ........ [[31mERROR[0m in 0.04s]
[0m16:11:46.765663 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:11:46.766184 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.fact_meter_readings' to be skipped because of status 'error'.  Reason: Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  column ekm_meter_readings.meter_key does not exist
  LINE 32: on ekm_meter_readings.meter_key = dim_meters.meter_key
              ^
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql.
[0m16:11:46.767602 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:46.767961 [debug] [MainThread]: On master: BEGIN
[0m16:11:46.768251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:46.780995 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:11:46.781769 [debug] [MainThread]: On master: COMMIT
[0m16:11:46.782539 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:46.782909 [debug] [MainThread]: On master: COMMIT
[0m16:11:46.784018 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:46.784468 [debug] [MainThread]: On master: Close
[0m16:11:46.784980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:46.785408 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:11:46.785824 [info ] [MainThread]: 
[0m16:11:46.786214 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m16:11:46.787511 [debug] [MainThread]: Command end result
[0m16:11:46.809712 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:11:46.811776 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:11:46.818870 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:11:46.819282 [info ] [MainThread]: 
[0m16:11:46.819663 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:11:46.820135 [info ] [MainThread]: 
[0m16:11:46.820550 [error] [MainThread]:   Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  column ekm_meter_readings.meter_key does not exist
  LINE 32: on ekm_meter_readings.meter_key = dim_meters.meter_key
              ^
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql
[0m16:11:46.820986 [info ] [MainThread]: 
[0m16:11:46.821521 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:11:46.824060 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4088321, "process_in_blocks": "0", "process_kernel_time": 0.413664, "process_mem_max_rss": "116654080", "process_out_blocks": "0", "process_user_time": 2.481085}
[0m16:11:46.824648 [debug] [MainThread]: Command `dbt build` failed at 16:11:46.824519 after 1.41 seconds
[0m16:11:46.825070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d60b0>]}
[0m16:11:46.825442 [debug] [MainThread]: Flushing usage events
[0m16:11:47.081329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:16.773078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103786270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b03ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b03c50>]}


============================== 16:12:16.780389 | b302f4c8-5dd7-4807-ab8e-f219365c58d0 ==============================
[0m16:12:16.780389 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:12:16.781040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:12:16.989029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503dba0>]}
[0m16:12:17.050766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a99480>]}
[0m16:12:17.052366 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:12:17.162838 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:12:17.287477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:17.287971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:17.332225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa0850>]}
[0m16:12:17.404565 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:12:17.408275 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:12:17.457061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fea990>]}
[0m16:12:17.457579 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:12:17.459821 [info ] [MainThread]: 
[0m16:12:17.460222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:17.460529 [info ] [MainThread]: 
[0m16:12:17.461067 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:12:17.466305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:12:17.533670 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:12:17.534132 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:12:17.534497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:17.565839 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m16:12:17.567312 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:12:17.568900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:12:17.575364 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:12:17.575800 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:12:17.576191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:17.587602 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:12:17.588050 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:12:17.588408 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:12:17.591482 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m16:12:17.593008 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:12:17.594029 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:12:17.598973 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:17.599392 [debug] [MainThread]: On master: BEGIN
[0m16:12:17.599920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:17.611636 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:12:17.612094 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:17.612473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:12:17.616253 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m16:12:17.617617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d7d90>]}
[0m16:12:17.618149 [debug] [MainThread]: On master: ROLLBACK
[0m16:12:17.619062 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:17.619415 [debug] [MainThread]: On master: BEGIN
[0m16:12:17.620874 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:12:17.621266 [debug] [MainThread]: On master: COMMIT
[0m16:12:17.621566 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:17.621836 [debug] [MainThread]: On master: COMMIT
[0m16:12:17.622667 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:12:17.623018 [debug] [MainThread]: On master: Close
[0m16:12:17.626321 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:12:17.626949 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:12:17.627457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:12:17.627824 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:12:17.641429 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:12:17.642954 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:12:17.679666 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:12:17.681323 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:12:17.681756 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:12:17.682108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:17.694714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:12:17.695219 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:12:17.695608 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:12:17.698161 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:12:17.704288 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:12:17.704743 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:12:17.706132 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:12:17.708893 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:12:17.709802 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:12:17.711258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:12:17.727687 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:12:17.728186 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:12:17.728533 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:12:17.755394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m16:12:17.766019 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:12:17.773725 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:12:17.774287 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:12:17.780902 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m16:12:17.783556 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:12:17.785975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2a0d0>]}
[0m16:12:17.786908 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.16s]
[0m16:12:17.787565 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:12:17.787997 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:12:17.788480 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:12:17.788950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:12:17.789402 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:12:17.789740 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:12:17.819908 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:12:17.820467 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:12:17.820823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:17.833336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:12:17.833849 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:12:17.834208 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:12:17.837499 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m16:12:17.854593 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:12:17.855103 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:12:17.856792 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:12:17.863231 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:12:17.866035 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:12:17.866476 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:12:17.866834 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:12:17.870913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:12:17.871810 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:12:17.872403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abb110>]}
[0m16:12:17.872986 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.08s]
[0m16:12:17.873721 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:12:17.874618 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:12:17.875316 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:12:17.876016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:12:17.876432 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:12:17.879578 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:12:17.881348 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:12:17.906461 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:12:17.907367 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:12:17.907738 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:12:17.908057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:17.920022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:12:17.920518 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:12:17.920903 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    meter_address, 
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:12:17.923983 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:12:17.930500 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:12:17.930964 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:12:17.932593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:12:17.935499 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:12:17.935897 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:12:17.937119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:12:17.938706 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:12:17.939081 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:12:17.939408 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:12:17.943459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:12:17.946404 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:12:17.949518 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:12:17.949969 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:12:17.954699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:12:17.956215 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:12:17.956938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9bee0>]}
[0m16:12:17.957668 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:12:17.958414 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:12:17.959321 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:12:17.959921 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:12:17.960678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:12:17.961172 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:12:17.964827 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:12:17.965924 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:12:17.970336 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:12:17.971341 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:12:17.971837 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:12:17.972281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:17.984821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:12:17.985407 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:12:17.985849 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    meter_key,
    dim_meters.name as meter_name,
    meter_type,
    start_date_time,
    end_date_time,
    total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:12:17.989278 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text = integer
LINE 32: on ekm_meter_readings.meter_address = dim_meters.meter_addre...
                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m16:12:17.989848 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: ROLLBACK
[0m16:12:17.990942 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:12:18.003093 [debug] [Thread-1 (]: Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  operator does not exist: text = integer
  LINE 32: on ekm_meter_readings.meter_address = dim_meters.meter_addre...
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql
[0m16:12:18.003675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b302f4c8-5dd7-4807-ab8e-f219365c58d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f574d0>]}
[0m16:12:18.004308 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model vtec_dbt_test.fact_meter_readings ........ [[31mERROR[0m in 0.04s]
[0m16:12:18.004899 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:12:18.005428 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.fact_meter_readings' to be skipped because of status 'error'.  Reason: Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  operator does not exist: text = integer
  LINE 32: on ekm_meter_readings.meter_address = dim_meters.meter_addre...
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql.
[0m16:12:18.006802 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:18.007170 [debug] [MainThread]: On master: BEGIN
[0m16:12:18.007453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:18.019798 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:12:18.020303 [debug] [MainThread]: On master: COMMIT
[0m16:12:18.020635 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:18.020927 [debug] [MainThread]: On master: COMMIT
[0m16:12:18.021648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:12:18.021980 [debug] [MainThread]: On master: Close
[0m16:12:18.022428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:18.022748 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:12:18.023133 [info ] [MainThread]: 
[0m16:12:18.023516 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m16:12:18.024780 [debug] [MainThread]: Command end result
[0m16:12:18.045418 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:12:18.047717 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:12:18.055328 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:12:18.055773 [info ] [MainThread]: 
[0m16:12:18.056165 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:12:18.056563 [info ] [MainThread]: 
[0m16:12:18.057101 [error] [MainThread]:   Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  operator does not exist: text = integer
  LINE 32: on ekm_meter_readings.meter_address = dim_meters.meter_addre...
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/jaffle_shop/models/core/fact_meter_readings.sql
[0m16:12:18.057470 [info ] [MainThread]: 
[0m16:12:18.057991 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:12:18.060777 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.3728848, "process_in_blocks": "0", "process_kernel_time": 0.416255, "process_mem_max_rss": "116756480", "process_out_blocks": "0", "process_user_time": 2.402826}
[0m16:12:18.061355 [debug] [MainThread]: Command `dbt build` failed at 16:12:18.061232 after 1.37 seconds
[0m16:12:18.061765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058113d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058419d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b460b0>]}
[0m16:12:18.062130 [debug] [MainThread]: Flushing usage events
[0m16:12:18.313355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:55.297396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fefed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fefc50>]}


============================== 16:13:55.304323 | d9b6e633-0c49-4103-9a89-7770a6d3121a ==============================
[0m16:13:55.304323 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:13:55.304978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m16:13:55.506379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9b6e633-0c49-4103-9a89-7770a6d3121a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109529ba0>]}
[0m16:13:55.570334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9b6e633-0c49-4103-9a89-7770a6d3121a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7d480>]}
[0m16:13:55.571742 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:13:55.685347 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:13:55.802702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:55.803208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:55.843668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9b6e633-0c49-4103-9a89-7770a6d3121a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109108850>]}
[0m16:13:55.923970 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:13:55.927547 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:13:55.993460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9b6e633-0c49-4103-9a89-7770a6d3121a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914ea80>]}
[0m16:13:55.994142 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 433 macros
[0m16:13:55.997141 [info ] [MainThread]: 
[0m16:13:55.997925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:13:55.998542 [info ] [MainThread]: 
[0m16:13:55.999284 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:56.016461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:13:56.109829 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:13:56.110274 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:13:56.110606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:56.157964 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.047 seconds
[0m16:13:56.159400 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:13:56.160984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:13:56.167186 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:13:56.167626 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:13:56.167944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:56.181761 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m16:13:56.182269 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:13:56.182618 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:13:56.188510 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m16:13:56.190023 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:13:56.191085 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:13:56.195938 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:56.196379 [debug] [MainThread]: On master: BEGIN
[0m16:13:56.196665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:56.208851 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:13:56.209330 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:56.209717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:56.215335 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:13:56.216694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9b6e633-0c49-4103-9a89-7770a6d3121a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb3d90>]}
[0m16:13:56.217187 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:56.218242 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:56.218648 [debug] [MainThread]: On master: BEGIN
[0m16:13:56.220251 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:13:56.220720 [debug] [MainThread]: On master: COMMIT
[0m16:13:56.221048 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:56.221332 [debug] [MainThread]: On master: COMMIT
[0m16:13:56.222450 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:13:56.222859 [debug] [MainThread]: On master: Close
[0m16:13:56.227341 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:13:56.228006 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:13:56.228578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:13:56.229001 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:13:56.243822 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:13:56.245133 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:13:56.285620 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:13:56.287385 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:13:56.287910 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:13:56.288307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:56.300290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:13:56.300797 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:13:56.301188 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:13:56.304162 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:13:56.310325 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:13:56.310765 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:13:56.312258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:13:56.315292 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:13:56.316184 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:13:56.317812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:13:56.335555 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:13:56.336080 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:13:56.336456 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:13:56.343073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:13:56.349293 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:13:56.354712 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:13:56.355209 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:13:56.361309 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m16:13:56.364145 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:13:56.366645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b6e633-0c49-4103-9a89-7770a6d3121a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ea0d0>]}
[0m16:13:56.367665 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.14s]
[0m16:13:56.368530 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:13:56.369039 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:13:56.369828 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:13:56.370448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:13:56.370892 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:13:56.371279 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:13:56.403685 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:13:56.404189 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:13:56.404534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:56.420729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:13:56.421524 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:13:56.422183 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:13:56.426281 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m16:13:56.453552 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:13:56.454045 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:13:56.455754 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:13:56.462563 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:13:56.464738 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:13:56.465364 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:13:56.465750 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:13:56.470751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:13:56.471673 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:13:56.472287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b6e633-0c49-4103-9a89-7770a6d3121a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f8f110>]}
[0m16:13:56.472922 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.10s]
[0m16:13:56.473875 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:13:56.475416 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:13:56.476098 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:13:56.476698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:13:56.477106 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:13:56.481437 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:13:56.482697 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:13:56.507774 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:13:56.508769 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:13:56.509171 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:13:56.509501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:56.524138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:13:56.524716 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:13:56.525090 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:13:56.526767 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "meter" does not exist
LINE 18:     cast(meter as TEXT)
                  ^

[0m16:13:56.527272 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: ROLLBACK
[0m16:13:56.528540 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:13:56.543950 [debug] [Thread-1 (]: Database Error in model dim_meters (models/core/dim_meters.sql)
  column "meter" does not exist
  LINE 18:     cast(meter as TEXT)
                    ^
  compiled code at target/run/jaffle_shop/models/core/dim_meters.sql
[0m16:13:56.544570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b6e633-0c49-4103-9a89-7770a6d3121a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f77a10>]}
[0m16:13:56.545258 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model vtec_dbt_test.dim_meters ................. [[31mERROR[0m in 0.07s]
[0m16:13:56.545988 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:13:56.546585 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.dim_meters' to be skipped because of status 'error'.  Reason: Database Error in model dim_meters (models/core/dim_meters.sql)
  column "meter" does not exist
  LINE 18:     cast(meter as TEXT)
                    ^
  compiled code at target/run/jaffle_shop/models/core/dim_meters.sql.
[0m16:13:56.547496 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:13:56.547895 [info ] [Thread-1 (]: 4 of 4 SKIP relation vtec_dbt_test.fact_meter_readings ......................... [[33mSKIP[0m]
[0m16:13:56.548369 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:13:56.548935 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.fact_meter_readings' to be skipped because of status 'skipped'. 
[0m16:13:56.550379 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:56.550753 [debug] [MainThread]: On master: BEGIN
[0m16:13:56.551044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:56.564552 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:13:56.565042 [debug] [MainThread]: On master: COMMIT
[0m16:13:56.565381 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:56.565678 [debug] [MainThread]: On master: COMMIT
[0m16:13:56.566573 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:13:56.566980 [debug] [MainThread]: On master: Close
[0m16:13:56.567439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:56.567790 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_meters' was properly closed.
[0m16:13:56.568197 [info ] [MainThread]: 
[0m16:13:56.568712 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m16:13:56.570734 [debug] [MainThread]: Command end result
[0m16:13:56.591405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:13:56.611658 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:13:56.621019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:13:56.621475 [info ] [MainThread]: 
[0m16:13:56.621967 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:13:56.622348 [info ] [MainThread]: 
[0m16:13:56.622856 [error] [MainThread]:   Database Error in model dim_meters (models/core/dim_meters.sql)
  column "meter" does not exist
  LINE 18:     cast(meter as TEXT)
                    ^
  compiled code at target/run/jaffle_shop/models/core/dim_meters.sql
[0m16:13:56.623440 [info ] [MainThread]: 
[0m16:13:56.624041 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m16:13:56.627818 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4113331, "process_in_blocks": "0", "process_kernel_time": 0.453065, "process_mem_max_rss": "116854784", "process_out_blocks": "0", "process_user_time": 2.413913}
[0m16:13:56.628452 [debug] [MainThread]: Command `dbt build` failed at 16:13:56.628309 after 1.41 seconds
[0m16:13:56.628927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4000f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf1050>]}
[0m16:13:56.630163 [debug] [MainThread]: Flushing usage events
[0m16:13:56.890029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:10.301075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b842270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbefed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbefc50>]}


============================== 16:14:10.307711 | dfb8ba40-8b51-4350-b3da-e55480e59c45 ==============================
[0m16:14:10.307711 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:14:10.308354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:10.497097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d131ba0>]}
[0m16:14:10.572170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb85480>]}
[0m16:14:10.573480 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:14:10.686924 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:14:10.847219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:10.847693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:10.892588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd0c850>]}
[0m16:14:10.971861 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:14:10.975414 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:14:11.021067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd56990>]}
[0m16:14:11.021590 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 433 macros
[0m16:14:11.023865 [info ] [MainThread]: 
[0m16:14:11.024308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:11.024622 [info ] [MainThread]: 
[0m16:14:11.025234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:11.031064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:14:11.095118 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:14:11.095562 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:14:11.095903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:11.127679 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.032 seconds
[0m16:14:11.129150 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:14:11.130734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:14:11.136567 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:14:11.136993 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:14:11.137291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:11.149002 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:14:11.149476 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:14:11.149811 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:14:11.152882 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m16:14:11.154313 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:14:11.155180 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:14:11.160385 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:11.160978 [debug] [MainThread]: On master: BEGIN
[0m16:14:11.161327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:11.172400 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:14:11.172912 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:11.173313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:11.177217 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m16:14:11.178577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dab7d90>]}
[0m16:14:11.179097 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:11.180096 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:11.180496 [debug] [MainThread]: On master: BEGIN
[0m16:14:11.181606 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:14:11.182000 [debug] [MainThread]: On master: COMMIT
[0m16:14:11.182314 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:11.182590 [debug] [MainThread]: On master: COMMIT
[0m16:14:11.183312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:11.183711 [debug] [MainThread]: On master: Close
[0m16:14:11.186847 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:14:11.187480 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:14:11.187996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:14:11.188368 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:14:11.201777 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:14:11.202635 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:14:11.239608 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:14:11.240589 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:14:11.240980 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:14:11.241323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:11.254115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:14:11.254630 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:14:11.255048 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:14:11.258002 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:14:11.265102 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:14:11.265610 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:14:11.267804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:14:11.270632 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:14:11.271446 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:14:11.272769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:14:11.289900 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:14:11.290420 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:14:11.290772 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:14:11.295321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:14:11.301581 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:14:11.306923 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:14:11.307382 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:14:11.312947 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:14:11.315502 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:14:11.317895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dff2000>]}
[0m16:14:11.318799 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.13s]
[0m16:14:11.319453 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:14:11.319867 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:14:11.320437 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:14:11.320949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:14:11.321314 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:14:11.321658 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:14:11.352533 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:14:11.353027 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:14:11.353376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:11.365497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:14:11.366012 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:14:11.366374 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:14:11.369512 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m16:14:11.414492 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:14:11.415405 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:14:11.419155 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.003 seconds
[0m16:14:11.432670 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:14:11.436984 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:14:11.437979 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:14:11.438475 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:14:11.442777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:14:11.443975 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:14:11.444974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db9b1d0>]}
[0m16:14:11.445940 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.12s]
[0m16:14:11.447090 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:14:11.448265 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:14:11.449164 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:14:11.449827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:14:11.450268 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:14:11.456257 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:14:11.457413 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:14:11.489489 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:14:11.490492 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:14:11.490917 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:14:11.491255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:11.506069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:14:11.506608 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:14:11.507083 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:14:11.511176 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:14:11.519765 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:14:11.520329 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:14:11.522083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:14:11.526590 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:14:11.527358 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:14:11.529047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:14:11.531436 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:14:11.531982 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:14:11.532398 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:14:11.538332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:14:11.541541 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:14:11.545152 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:14:11.545668 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:14:11.569901 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.024 seconds
[0m16:14:11.571766 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:14:11.572722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da17330>]}
[0m16:14:11.573547 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.12s]
[0m16:14:11.574691 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:14:11.575854 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:14:11.576525 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:14:11.577333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:14:11.577847 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:14:11.583905 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:14:11.586951 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:14:11.594099 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:14:11.595276 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:14:11.595742 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:14:11.596083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:11.611982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:14:11.613003 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:14:11.614337 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    meter_key,
    dim_meters.name as meter_name,
    meter_type,
    start_date_time,
    end_date_time,
    total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:14:11.710479 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.096 seconds
[0m16:14:11.713524 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:14:11.713930 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:14:11.715259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:14:11.716725 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:14:11.717111 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:14:11.717440 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:14:11.752877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m16:14:11.755270 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:14:11.756467 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:14:11.756992 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:14:11.758649 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:14:11.760272 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:14:11.761103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb8ba40-8b51-4350-b3da-e55480e59c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e06fe30>]}
[0m16:14:11.766313 [info ] [Thread-1 (]: 4 of 4 OK created sql table model vtec_dbt_test.fact_meter_readings ............ [[32mSELECT 100[0m in 0.18s]
[0m16:14:11.788076 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:14:11.789845 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:11.790322 [debug] [MainThread]: On master: BEGIN
[0m16:14:11.790661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:11.873935 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m16:14:11.874428 [debug] [MainThread]: On master: COMMIT
[0m16:14:11.874972 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:11.875352 [debug] [MainThread]: On master: COMMIT
[0m16:14:11.876874 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:14:11.877335 [debug] [MainThread]: On master: Close
[0m16:14:11.877905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:11.878295 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:14:11.878727 [info ] [MainThread]: 
[0m16:14:11.879129 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m16:14:11.882930 [debug] [MainThread]: Command end result
[0m16:14:11.904966 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:14:11.908105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:14:11.915729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:14:11.916260 [info ] [MainThread]: 
[0m16:14:11.916760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:11.917419 [info ] [MainThread]: 
[0m16:14:11.917953 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:14:11.920592 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7019008, "process_in_blocks": "0", "process_kernel_time": 0.434873, "process_mem_max_rss": "117596160", "process_out_blocks": "0", "process_user_time": 2.615494}
[0m16:14:11.921194 [debug] [MainThread]: Command `dbt build` succeeded at 16:14:11.921058 after 1.70 seconds
[0m16:14:11.921673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10def6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd5b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc360b0>]}
[0m16:14:11.922108 [debug] [MainThread]: Flushing usage events
[0m16:14:12.184424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:07.639886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d44a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ffc50>]}


============================== 16:15:07.645421 | d08e24bd-0d9b-4d44-bff3-56e15a51064f ==============================
[0m16:15:07.645421 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:15:07.646177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m16:15:07.822687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed3dba0>]}
[0m16:15:07.880007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e78d480>]}
[0m16:15:07.880984 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:15:07.987168 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:15:08.113370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:08.113857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:08.159076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e914850>]}
[0m16:15:08.232643 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:15:08.235985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:15:08.264666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e95e990>]}
[0m16:15:08.265186 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 433 macros
[0m16:15:08.267370 [info ] [MainThread]: 
[0m16:15:08.267776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:15:08.268094 [info ] [MainThread]: 
[0m16:15:08.268619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:08.274383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:15:08.340839 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:15:08.341276 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:15:08.341603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:08.371543 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.030 seconds
[0m16:15:08.373067 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:15:08.374745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:15:08.381079 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:15:08.381699 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:15:08.382036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:08.394222 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:15:08.394714 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:15:08.395039 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:15:08.399139 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m16:15:08.400580 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:15:08.401469 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:15:08.406608 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:08.407036 [debug] [MainThread]: On master: BEGIN
[0m16:15:08.407334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:08.419642 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:15:08.420099 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:08.420520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:08.425494 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:15:08.426858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d3d90>]}
[0m16:15:08.427357 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:08.428594 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:08.428989 [debug] [MainThread]: On master: BEGIN
[0m16:15:08.431100 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:15:08.431549 [debug] [MainThread]: On master: COMMIT
[0m16:15:08.431884 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:08.432162 [debug] [MainThread]: On master: COMMIT
[0m16:15:08.433327 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:15:08.434037 [debug] [MainThread]: On master: Close
[0m16:15:08.437033 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:15:08.437720 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:15:08.438298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:15:08.438819 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:15:08.452356 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:15:08.453239 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:15:08.492127 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:15:08.493196 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:15:08.493635 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:15:08.493968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:08.507303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:15:08.507808 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:15:08.508187 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:15:08.510982 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:15:08.517297 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:15:08.517760 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:15:08.519468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:08.522479 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:15:08.523860 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:15:08.525546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:08.542326 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:15:08.542841 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:15:08.543198 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:15:08.566402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m16:15:08.574938 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:15:08.581835 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:15:08.582328 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:15:08.587258 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:15:08.589828 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:15:08.592040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc220d0>]}
[0m16:15:08.592901 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.15s]
[0m16:15:08.593625 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:15:08.594052 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:15:08.594526 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:15:08.595136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:15:08.595527 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:15:08.595886 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:15:08.628104 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:15:08.628615 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:15:08.628965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:08.640666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:15:08.641168 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:15:08.641539 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:15:08.643655 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:15:08.661131 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:15:08.661598 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:15:08.663053 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:15:08.669878 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:15:08.671895 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:15:08.672305 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:15:08.672643 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:15:08.677501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:15:08.678423 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:15:08.679031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7bb110>]}
[0m16:15:08.679631 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.08s]
[0m16:15:08.680284 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:15:08.681287 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:15:08.681945 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:15:08.682503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:15:08.682922 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:15:08.686249 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:15:08.687797 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:15:08.712379 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:15:08.713461 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:15:08.713970 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:15:08.714390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:08.726887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:15:08.727405 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:15:08.727780 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:15:08.732812 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m16:15:08.739858 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:15:08.740317 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:15:08.741711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:08.744422 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:15:08.744816 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:15:08.746071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:08.747691 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:15:08.748079 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:15:08.748398 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:15:08.752570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:15:08.755355 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:15:08.758376 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:15:08.758775 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:15:08.763000 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:15:08.764683 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:15:08.765319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a3ee0>]}
[0m16:15:08.766022 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:15:08.766657 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:15:08.767587 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:15:08.768195 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:15:08.768687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:15:08.769059 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:15:08.771924 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:15:08.773332 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:15:08.778059 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:15:08.778938 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:15:08.779321 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:15:08.779677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:08.794979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:15:08.795672 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:15:08.796307 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:15:08.894118 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.097 seconds
[0m16:15:08.897095 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:15:08.897477 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" rename to "fact_meter_readings__dbt_backup"
[0m16:15:08.898749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:08.901443 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:15:08.901845 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:15:08.903216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:15:08.904906 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:15:08.905282 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:15:08.905602 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:15:08.909332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:15:08.911916 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:15:08.912649 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:15:08.913020 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:15:08.917375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:15:08.919047 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:15:08.919727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08e24bd-0d9b-4d44-bff3-56e15a51064f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fca6f30>]}
[0m16:15:08.920496 [info ] [Thread-1 (]: 4 of 4 OK created sql table model vtec_dbt_test.fact_meter_readings ............ [[32mSELECT 100[0m in 0.15s]
[0m16:15:08.921206 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:15:08.922830 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:08.923308 [debug] [MainThread]: On master: BEGIN
[0m16:15:08.923681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:08.940022 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:15:08.940473 [debug] [MainThread]: On master: COMMIT
[0m16:15:08.940789 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:08.941067 [debug] [MainThread]: On master: COMMIT
[0m16:15:08.941825 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:08.942160 [debug] [MainThread]: On master: Close
[0m16:15:08.942599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:08.943083 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:15:08.943547 [info ] [MainThread]: 
[0m16:15:08.943984 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m16:15:08.945768 [debug] [MainThread]: Command end result
[0m16:15:08.964415 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:15:08.966757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:15:08.975166 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:15:08.975556 [info ] [MainThread]: 
[0m16:15:08.975975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:08.976321 [info ] [MainThread]: 
[0m16:15:08.976697 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:15:08.978527 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4183944, "process_in_blocks": "0", "process_kernel_time": 0.361613, "process_mem_max_rss": "116756480", "process_out_blocks": "0", "process_user_time": 2.337718}
[0m16:15:08.979056 [debug] [MainThread]: Command `dbt build` succeeded at 16:15:08.978940 after 1.42 seconds
[0m16:15:08.979451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f50d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f53fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e83e0b0>]}
[0m16:15:08.979825 [debug] [MainThread]: Flushing usage events
[0m16:15:09.224150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:59.697316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e97ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e97c50>]}


============================== 16:20:59.703993 | 0ea5fc8f-1448-4325-b580-e782a33a67c5 ==============================
[0m16:20:59.703993 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:20:59.704655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --vars {is_test_run:false}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:59.909105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d9ba0>]}
[0m16:20:59.972252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e29480>]}
[0m16:20:59.973861 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:21:00.087789 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:21:00.195050 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:21:00.195655 [debug] [MainThread]: previous checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m16:21:00.196040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb3450>]}
[0m16:21:01.478513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d875c0>]}
[0m16:21:01.577618 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:21:01.581920 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:21:01.702748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f273f0>]}
[0m16:21:01.703314 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:21:01.705449 [info ] [MainThread]: 
[0m16:21:01.705855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:01.706376 [info ] [MainThread]: 
[0m16:21:01.706906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:01.712261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:21:01.788866 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:21:01.789318 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:21:01.789835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:01.823636 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.034 seconds
[0m16:21:01.825105 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:21:01.826621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:21:01.832475 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:21:01.832898 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:21:01.833201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:01.844555 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:21:01.845011 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:21:01.845345 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:21:01.851194 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m16:21:01.852656 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:21:01.853595 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:21:01.858625 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:01.859048 [debug] [MainThread]: On master: BEGIN
[0m16:21:01.859341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:01.870945 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:21:01.871453 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:01.871879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:01.877027 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:21:01.878374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26f110>]}
[0m16:21:01.878851 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:01.879878 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:01.880274 [debug] [MainThread]: On master: BEGIN
[0m16:21:01.881678 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:21:01.882101 [debug] [MainThread]: On master: COMMIT
[0m16:21:01.882417 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:01.882701 [debug] [MainThread]: On master: COMMIT
[0m16:21:01.883494 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:21:01.883861 [debug] [MainThread]: On master: Close
[0m16:21:01.887246 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:21:01.887845 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:21:01.888981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:21:01.889431 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:21:01.900077 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:21:01.901264 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:21:01.940095 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:21:01.941576 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:21:01.941986 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:21:01.942320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:01.955163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:21:01.955695 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:21:01.956092 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:21:01.959046 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:21:01.965562 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:21:01.966033 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:21:01.967537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:01.973986 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:21:01.974504 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:21:01.975976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:01.993405 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:21:01.993936 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:21:01.994298 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:21:02.000413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:21:02.006716 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:21:02.011928 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:21:02.012344 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:21:02.017933 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:21:02.020464 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:21:02.022616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9fa10>]}
[0m16:21:02.023517 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.13s]
[0m16:21:02.024201 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:21:02.024620 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:21:02.025197 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:21:02.025723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:21:02.026091 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:21:02.026447 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:21:02.056306 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:21:02.056790 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:21:02.057134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:02.069402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:21:02.069987 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:21:02.070381 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:21:02.072623 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:21:02.090029 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:21:02.090493 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:21:02.092047 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:21:02.098375 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:21:02.101084 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:21:02.101520 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:21:02.101855 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:21:02.105363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:21:02.106291 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:21:02.106891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb7ee0>]}
[0m16:21:02.107518 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.08s]
[0m16:21:02.108151 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:21:02.109181 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:21:02.109836 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:21:02.110446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:21:02.110861 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:21:02.114854 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:21:02.116608 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:21:02.141453 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:21:02.142429 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:21:02.142820 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:21:02.143148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:02.155916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:21:02.156415 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:21:02.156779 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:21:02.159438 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m16:21:02.166003 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:21:02.166467 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:21:02.168037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:02.170770 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:21:02.171146 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:21:02.172322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:02.173921 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:21:02.174299 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:21:02.174628 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:21:02.178314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:21:02.181094 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:21:02.184052 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:21:02.184450 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:21:02.188892 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:21:02.190372 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:21:02.190963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f80f0>]}
[0m16:21:02.191653 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:21:02.192285 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:21:02.193150 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:21:02.193729 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:21:02.194262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:21:02.194662 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:21:02.198084 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:21:02.199687 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:21:02.203955 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:21:02.204841 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:21:02.205430 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:21:02.205833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:02.218994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:21:02.219505 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:21:02.219908 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:21:02.350378 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.130 seconds
[0m16:21:02.353417 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:21:02.353809 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" rename to "fact_meter_readings__dbt_backup"
[0m16:21:02.355116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:02.357948 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:21:02.358380 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:21:02.360024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:02.361729 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:21:02.362132 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:21:02.362488 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:21:02.366627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:21:02.369681 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:21:02.370601 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:21:02.371051 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:21:02.375929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:21:02.377621 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:21:02.378286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea5fc8f-1448-4325-b580-e782a33a67c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b02d0>]}
[0m16:21:02.379058 [info ] [Thread-1 (]: 4 of 4 OK created sql table model vtec_dbt_test.fact_meter_readings ............ [[32mSELECT 100[0m in 0.18s]
[0m16:21:02.379814 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:21:02.381402 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:02.381824 [debug] [MainThread]: On master: BEGIN
[0m16:21:02.382126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:02.396675 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:21:02.397182 [debug] [MainThread]: On master: COMMIT
[0m16:21:02.397565 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:02.398060 [debug] [MainThread]: On master: COMMIT
[0m16:21:02.399371 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:21:02.399818 [debug] [MainThread]: On master: Close
[0m16:21:02.400281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:02.400577 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:21:02.400948 [info ] [MainThread]: 
[0m16:21:02.401347 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m16:21:02.402569 [debug] [MainThread]: Command end result
[0m16:21:02.429849 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:21:02.433088 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:21:02.440991 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:21:02.441400 [info ] [MainThread]: 
[0m16:21:02.441818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:02.442156 [info ] [MainThread]: 
[0m16:21:02.442493 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:21:02.444514 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.8297923, "process_in_blocks": "0", "process_kernel_time": 0.483275, "process_mem_max_rss": "121315328", "process_out_blocks": "0", "process_user_time": 3.588771}
[0m16:21:02.445070 [debug] [MainThread]: Command `dbt build` succeeded at 16:21:02.444946 after 2.83 seconds
[0m16:21:02.445471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eda0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c49d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6b3b0>]}
[0m16:21:02.445845 [debug] [MainThread]: Flushing usage events
[0m16:21:02.772481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:21.277419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105146270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fbc50>]}


============================== 16:22:21.282953 | d5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a ==============================
[0m16:22:21.282953 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:22:21.283949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --vars {is_test_run:false}', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:22:21.504135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a39ba0>]}
[0m16:22:21.585357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106489480>]}
[0m16:22:21.586325 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:22:21.693000 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:22:21.826500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:21.827056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:21.872020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106610850>]}
[0m16:22:21.948117 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:22:21.951438 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:22:21.980320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665a990>]}
[0m16:22:21.980844 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:22:21.983051 [info ] [MainThread]: 
[0m16:22:21.983458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:21.983764 [info ] [MainThread]: 
[0m16:22:21.984274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:21.989469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:22:22.055357 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:22:22.055981 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:22:22.056764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:22.084834 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.028 seconds
[0m16:22:22.086335 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:22:22.087941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:22:22.093588 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:22:22.094058 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:22:22.094433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:22.106327 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:22:22.106808 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:22:22.107137 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:22:22.111258 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m16:22:22.112740 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:22:22.113689 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:22:22.118654 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:22.119055 [debug] [MainThread]: On master: BEGIN
[0m16:22:22.119344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:22.130718 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:22:22.131174 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:22.131588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:22.136505 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m16:22:22.137914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cfd90>]}
[0m16:22:22.138404 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:22.139395 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:22.139808 [debug] [MainThread]: On master: BEGIN
[0m16:22:22.141134 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:22:22.141526 [debug] [MainThread]: On master: COMMIT
[0m16:22:22.141846 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:22.142119 [debug] [MainThread]: On master: COMMIT
[0m16:22:22.142927 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:22:22.143331 [debug] [MainThread]: On master: Close
[0m16:22:22.145644 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:22:22.146387 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:22:22.146921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:22:22.147345 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:22:22.162210 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:22:22.163066 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:22:22.199257 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:22:22.200358 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:22:22.200755 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:22:22.201083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:22.213101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:22:22.213600 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:22:22.213991 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:22:22.216601 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:22:22.222630 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:22:22.223063 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:22:22.224420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.227232 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:22:22.228093 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:22:22.229414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.246097 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:22:22.246627 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:22:22.246993 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:22:22.278555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m16:22:22.284892 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:22:22.290354 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:22:22.290846 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:22:22.295484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:22:22.298253 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:22:22.300447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079220d0>]}
[0m16:22:22.301336 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.15s]
[0m16:22:22.302081 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:22:22.302507 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:22:22.303186 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:22:22.303776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:22:22.304187 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:22:22.304560 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:22:22.338443 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:22:22.338958 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:22:22.339298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:22.352495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:22:22.353014 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:22:22.353460 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:22:22.355684 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:22:22.386701 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:22:22.387202 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:22:22.388844 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:22:22.395473 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:22:22.397495 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:22:22.397927 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:22:22.398273 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:22:22.540639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.142 seconds
[0m16:22:22.542411 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:22:22.543373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b7110>]}
[0m16:22:22.544239 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.24s]
[0m16:22:22.545153 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:22:22.546559 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:22:22.547325 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:22:22.548069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:22:22.548600 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:22:22.553859 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:22:22.555108 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:22:22.673481 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:22:22.674638 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:22:22.675081 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:22:22.675404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:22.690326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:22:22.690861 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:22:22.691210 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:22:22.694989 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:22:22.701603 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:22:22.702040 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:22:22.703796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.707052 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:22:22.707519 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:22:22.708826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.710630 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:22:22.711086 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:22:22.711443 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:22:22.741760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m16:22:22.744909 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:22:22.749076 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:22:22.749656 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:22:22.760628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:22:22.762512 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:22:22.763475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732f330>]}
[0m16:22:22.764747 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.22s]
[0m16:22:22.766074 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:22:22.767210 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:22:22.767953 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:22:22.768650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:22:22.769145 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:22:22.775801 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:22:22.778559 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:22:22.783058 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:22:22.784124 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:22:22.784756 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:22:22.785253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:22.803042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:22:22.803573 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:22:22.804014 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:22:22.957495 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.153 seconds
[0m16:22:22.962991 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:22:22.963961 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" rename to "fact_meter_readings__dbt_backup"
[0m16:22:22.966191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.969608 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:22:22.970154 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:22:22.971797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.973606 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:22:22.974067 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:22:22.974422 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:22:22.978284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:22:22.981132 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:22:22.981969 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:22:22.982346 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:22:22.986611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:22:22.988143 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:22:22.988797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5a4a64f-eb67-48d2-b9e3-82b42d0cdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b3430>]}
[0m16:22:22.989692 [info ] [Thread-1 (]: 4 of 4 OK created sql table model vtec_dbt_test.fact_meter_readings ............ [[32mSELECT 100[0m in 0.22s]
[0m16:22:22.990660 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:22:22.992329 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:22.992727 [debug] [MainThread]: On master: BEGIN
[0m16:22:22.993014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:23.009498 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:22:23.010695 [debug] [MainThread]: On master: COMMIT
[0m16:22:23.011675 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:23.012389 [debug] [MainThread]: On master: COMMIT
[0m16:22:23.014149 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:22:23.014775 [debug] [MainThread]: On master: Close
[0m16:22:23.015511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:23.016141 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:22:23.016883 [info ] [MainThread]: 
[0m16:22:23.017887 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m16:22:23.019733 [debug] [MainThread]: Command end result
[0m16:22:23.041075 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:22:23.045075 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:22:23.053382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:22:23.053881 [info ] [MainThread]: 
[0m16:22:23.054610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:23.055202 [info ] [MainThread]: 
[0m16:22:23.055662 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:22:23.058214 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.8734694, "process_in_blocks": "0", "process_kernel_time": 0.36829, "process_mem_max_rss": "116711424", "process_out_blocks": "0", "process_user_time": 2.428844}
[0m16:22:23.058872 [debug] [MainThread]: Command `dbt build` succeeded at 16:22:23.058671 after 1.87 seconds
[0m16:22:23.061983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072093d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059afe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653a0b0>]}
[0m16:22:23.063945 [debug] [MainThread]: Flushing usage events
[0m16:22:23.408057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:19.815659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111637ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111637c50>]}


============================== 16:23:19.822312 | 81c433e0-1dd7-4c9b-b7c5-c43ce59db16c ==============================
[0m16:23:19.822312 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:23:19.823001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select ekm_data --vars {is_test_run:false}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:20.004418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81c433e0-1dd7-4c9b-b7c5-c43ce59db16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b75ba0>]}
[0m16:23:20.066487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81c433e0-1dd7-4c9b-b7c5-c43ce59db16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c5480>]}
[0m16:23:20.068094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:23:20.180951 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:23:20.378891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:20.379347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:20.422668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81c433e0-1dd7-4c9b-b7c5-c43ce59db16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111750850>]}
[0m16:23:20.494925 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:23:20.498518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:23:20.543664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81c433e0-1dd7-4c9b-b7c5-c43ce59db16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111796990>]}
[0m16:23:20.544222 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:23:20.544948 [warn ] [MainThread]: The selection criterion 'ekm_data' does not match any enabled nodes
[0m16:23:20.545565 [warn ] [MainThread]: The selection criterion 'ekm_data' does not match any enabled nodes
[0m16:23:20.546051 [warn ] [MainThread]: The selection criterion 'ekm_data' does not match any enabled nodes
[0m16:23:20.547940 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:23:20.550612 [debug] [MainThread]: Command end result
[0m16:23:20.572008 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:23:20.574003 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:23:20.577339 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:23:20.579423 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8433571, "process_in_blocks": "0", "process_kernel_time": 0.387526, "process_mem_max_rss": "108048384", "process_out_blocks": "0", "process_user_time": 2.052682}
[0m16:23:20.580035 [debug] [MainThread]: Command `dbt build` succeeded at 16:23:20.579898 after 0.84 seconds
[0m16:23:20.580529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c15b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112533ee0>]}
[0m16:23:20.581354 [debug] [MainThread]: Flushing usage events
[0m16:23:20.822972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:27.462273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a67ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a67c50>]}


============================== 16:24:27.468776 | 57bd8f38-9654-4aab-885d-512566d5a203 ==============================
[0m16:24:27.468776 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:24:27.469423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select stg_postgres__meter_readings --vars {is_test_run:false}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:24:27.653363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57bd8f38-9654-4aab-885d-512566d5a203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9dba0>]}
[0m16:24:27.714935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57bd8f38-9654-4aab-885d-512566d5a203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f9480>]}
[0m16:24:27.716592 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:27.829301 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:24:27.986739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:27.987230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:28.031979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57bd8f38-9654-4aab-885d-512566d5a203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f00850>]}
[0m16:24:28.108275 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:24:28.111946 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:24:28.158881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57bd8f38-9654-4aab-885d-512566d5a203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f46990>]}
[0m16:24:28.159505 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:24:28.161531 [info ] [MainThread]: 
[0m16:24:28.161954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:28.162267 [info ] [MainThread]: 
[0m16:24:28.162843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:28.163864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:24:28.322030 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:24:28.322472 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:24:28.322805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:28.353474 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m16:24:28.354933 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:24:28.359981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:24:28.365436 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:24:28.365870 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:24:28.366385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:28.378132 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:24:28.378582 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:24:28.378908 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:24:28.382888 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m16:24:28.384386 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:24:28.385263 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:24:28.390191 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:28.390604 [debug] [MainThread]: On master: BEGIN
[0m16:24:28.390902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:28.402437 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:24:28.402928 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:28.403319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:28.409137 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:24:28.410587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57bd8f38-9654-4aab-885d-512566d5a203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109937d90>]}
[0m16:24:28.411089 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:28.412050 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:28.412404 [debug] [MainThread]: On master: BEGIN
[0m16:24:28.413656 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:24:28.414059 [debug] [MainThread]: On master: COMMIT
[0m16:24:28.414366 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:28.414640 [debug] [MainThread]: On master: COMMIT
[0m16:24:28.415514 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:24:28.415839 [debug] [MainThread]: On master: Close
[0m16:24:28.418927 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:24:28.419562 [info ] [Thread-1 (]: 1 of 1 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:24:28.420066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:24:28.420442 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:24:28.434187 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:24:28.435051 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:24:28.472691 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:24:28.473659 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:24:28.474064 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:24:28.474396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:28.486592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:24:28.487083 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:24:28.487490 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:24:28.490565 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:24:28.496711 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:24:28.497165 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:24:28.498570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:28.501480 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:24:28.502440 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:24:28.504579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:24:28.523024 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:24:28.523521 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:24:28.523896 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:24:28.550813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m16:24:28.558196 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:24:28.563774 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:24:28.564269 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:24:28.568565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:24:28.571456 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:24:28.573780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57bd8f38-9654-4aab-885d-512566d5a203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e861a0>]}
[0m16:24:28.574771 [info ] [Thread-1 (]: 1 of 1 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.15s]
[0m16:24:28.575479 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:24:28.576815 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:28.577195 [debug] [MainThread]: On master: BEGIN
[0m16:24:28.577502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:28.592418 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:24:28.593055 [debug] [MainThread]: On master: COMMIT
[0m16:24:28.593438 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:28.593736 [debug] [MainThread]: On master: COMMIT
[0m16:24:28.594683 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:24:28.595150 [debug] [MainThread]: On master: Close
[0m16:24:28.595693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:28.596140 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m16:24:28.596532 [info ] [MainThread]: 
[0m16:24:28.597106 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m16:24:28.598408 [debug] [MainThread]: Command end result
[0m16:24:28.620287 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:24:28.622589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:24:28.629821 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:24:28.630232 [info ] [MainThread]: 
[0m16:24:28.630677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:28.631047 [info ] [MainThread]: 
[0m16:24:28.631458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:24:28.633666 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2965702, "process_in_blocks": "0", "process_kernel_time": 0.418933, "process_mem_max_rss": "116756480", "process_out_blocks": "0", "process_user_time": 2.282875}
[0m16:24:28.634205 [debug] [MainThread]: Command `dbt build` succeeded at 16:24:28.634087 after 1.30 seconds
[0m16:24:28.634614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108969cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a02f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a02fc0>]}
[0m16:24:28.634978 [debug] [MainThread]: Flushing usage events
[0m16:24:28.909835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:18.225958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb5e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df17ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df17c50>]}


============================== 16:25:18.230937 | a3a717fc-afcf-4633-82d5-6a8faf1849d3 ==============================
[0m16:25:18.230937 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:25:18.231580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --vars {is_test_run:false}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:18.413796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e451ba0>]}
[0m16:25:18.477670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dea5480>]}
[0m16:25:18.478689 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:25:18.579756 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:25:18.699614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:18.700027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:18.741685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e02c850>]}
[0m16:25:18.816785 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:25:18.819932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:25:18.848094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e076990>]}
[0m16:25:18.848657 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:25:18.850907 [info ] [MainThread]: 
[0m16:25:18.851310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:18.851612 [info ] [MainThread]: 
[0m16:25:18.852120 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:18.857036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:25:18.920580 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:25:18.921029 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:25:18.921378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:18.951645 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.030 seconds
[0m16:25:18.953092 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:25:18.954669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:25:18.960486 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:25:18.960916 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:25:18.961215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:18.972538 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:25:18.973019 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:25:18.973369 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:25:18.976947 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m16:25:18.978385 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:25:18.979406 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:25:18.984424 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:18.984838 [debug] [MainThread]: On master: BEGIN
[0m16:25:18.985146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:18.996350 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:25:18.996801 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:18.997207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:19.001120 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m16:25:19.002621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd7d90>]}
[0m16:25:19.003173 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:19.004158 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:19.004505 [debug] [MainThread]: On master: BEGIN
[0m16:25:19.005712 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:25:19.006140 [debug] [MainThread]: On master: COMMIT
[0m16:25:19.006456 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:19.006741 [debug] [MainThread]: On master: COMMIT
[0m16:25:19.007631 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:25:19.007992 [debug] [MainThread]: On master: Close
[0m16:25:19.010250 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:19.010964 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:25:19.011502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:25:19.011883 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:19.026691 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:19.027570 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:19.064085 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:19.065197 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:19.065633 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:25:19.065984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:19.079706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:25:19.080190 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:19.080571 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:25:19.083362 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:25:19.089432 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:19.089900 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:25:19.091415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:19.094220 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:19.095021 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:25:19.096358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:19.112798 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:25:19.113314 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:19.113686 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:25:19.118530 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:25:19.124810 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:25:19.130276 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:19.130761 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:25:19.135629 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:25:19.138239 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:25:19.140219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3120d0>]}
[0m16:25:19.141275 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.13s]
[0m16:25:19.142073 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:19.142520 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:25:19.143071 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:25:19.143565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:25:19.143932 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:25:19.144276 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:25:19.174501 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:25:19.175112 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:25:19.175544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:19.187122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:25:19.187632 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:25:19.187989 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:25:19.190085 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:25:19.207092 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:25:19.207575 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:25:19.209524 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:25:19.217326 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:25:19.232927 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:25:19.233556 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:25:19.233979 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:25:19.238900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:25:19.240003 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:25:19.240805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eebb110>]}
[0m16:25:19.241506 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.10s]
[0m16:25:19.242327 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:25:19.243440 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:25:19.244039 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:25:19.244537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:25:19.244907 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:25:19.249067 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:25:19.249999 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:25:19.275895 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:25:19.276876 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:19.277274 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:25:19.277603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:19.289625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:25:19.290133 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:19.290501 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:25:19.293185 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m16:25:19.299521 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:19.300294 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:25:19.302111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:19.304875 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:19.305273 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:25:19.306553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:19.308244 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:25:19.308637 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:19.308973 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:25:19.312131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:25:19.314713 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:25:19.317785 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:19.318237 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:25:19.322152 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:25:19.323635 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:25:19.324299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed3b330>]}
[0m16:25:19.325008 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:25:19.325628 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:25:19.326456 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:25:19.327034 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:25:19.327591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:25:19.328031 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:25:19.330926 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:25:19.332416 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:25:19.336987 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:25:19.337857 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:19.338229 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:25:19.338555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:19.351054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:25:19.351884 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:19.352316 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:25:19.429655 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.077 seconds
[0m16:25:19.432620 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:19.432999 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" rename to "fact_meter_readings__dbt_backup"
[0m16:25:19.434350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:19.437530 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:19.438002 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:25:19.439240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:19.440862 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:25:19.441397 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:19.441813 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:25:19.445030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:25:19.447576 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:25:19.448289 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:19.448647 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:25:19.454068 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:25:19.455516 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:25:19.456116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a717fc-afcf-4633-82d5-6a8faf1849d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f387430>]}
[0m16:25:19.456923 [info ] [Thread-1 (]: 4 of 4 OK created sql table model vtec_dbt_test.fact_meter_readings ............ [[32mSELECT 100[0m in 0.13s]
[0m16:25:19.457639 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:25:19.459135 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:19.459543 [debug] [MainThread]: On master: BEGIN
[0m16:25:19.459835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:19.472561 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:25:19.473025 [debug] [MainThread]: On master: COMMIT
[0m16:25:19.473355 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:19.473644 [debug] [MainThread]: On master: COMMIT
[0m16:25:19.474619 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:25:19.475220 [debug] [MainThread]: On master: Close
[0m16:25:19.476051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:19.476477 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:25:19.476913 [info ] [MainThread]: 
[0m16:25:19.477303 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m16:25:19.478553 [debug] [MainThread]: Command end result
[0m16:25:19.497632 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:25:19.499344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:25:19.505586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:25:19.505986 [info ] [MainThread]: 
[0m16:25:19.506375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:19.506680 [info ] [MainThread]: 
[0m16:25:19.507228 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:25:19.509597 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3632207, "process_in_blocks": "0", "process_kernel_time": 0.342139, "process_mem_max_rss": "116793344", "process_out_blocks": "0", "process_user_time": 2.302933}
[0m16:25:19.510153 [debug] [MainThread]: Command `dbt build` succeeded at 16:25:19.510033 after 1.36 seconds
[0m16:25:19.510572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec193d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec5ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df560b0>]}
[0m16:25:19.510982 [debug] [MainThread]: Flushing usage events
[0m16:25:19.805787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:25.177045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe76270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111223ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111223c50>]}


============================== 16:25:25.182096 | 9caf2322-d5a4-4179-b073-76f845f722b1 ==============================
[0m16:25:25.182096 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:25:25.182741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --vars {is_test_run:false}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:25.358591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111769ba0>]}
[0m16:25:25.420811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b9480>]}
[0m16:25:25.421832 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:25:25.520797 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:25:25.645662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:25.646114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:25.688343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111340850>]}
[0m16:25:25.761089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:25:25.764432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:25:25.791554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11138a990>]}
[0m16:25:25.792081 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:25:25.794294 [info ] [MainThread]: 
[0m16:25:25.794719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:25.795033 [info ] [MainThread]: 
[0m16:25:25.795548 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:25.800659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:25:25.887388 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:25:25.887822 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:25:25.888140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:25.921809 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.034 seconds
[0m16:25:25.923888 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:25:25.925674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:25:25.931597 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:25:25.932069 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:25:25.932388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:25.946866 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m16:25:25.947335 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:25:25.947671 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:25:25.951017 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m16:25:25.952538 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:25:25.953916 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:25:25.959366 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:25.959814 [debug] [MainThread]: On master: BEGIN
[0m16:25:25.960136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:25.972951 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:25:25.973416 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:25.973826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:25.977851 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m16:25:25.996090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ffd90>]}
[0m16:25:25.997024 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:25.998514 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:25.999070 [debug] [MainThread]: On master: BEGIN
[0m16:25:26.000744 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:25:26.001325 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.001802 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:26.002229 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.003401 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:25:26.003987 [debug] [MainThread]: On master: Close
[0m16:25:26.006926 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:26.007775 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:25:26.008486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:25:26.008984 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:26.024467 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:26.025385 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:26.063085 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:26.064091 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:26.064503 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:25:26.064835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:26.077777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:25:26.078284 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:26.078679 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:25:26.082187 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:25:26.088394 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:26.088854 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:25:26.090516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:26.093388 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:26.094292 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:25:26.095730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:26.114026 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:25:26.114637 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:26.115064 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:25:26.119013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:25:26.125313 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:25:26.130576 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:26.131063 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:25:26.134772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:25:26.137442 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:25:26.139427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126520d0>]}
[0m16:25:26.140401 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.13s]
[0m16:25:26.141267 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:26.141736 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:25:26.142313 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:25:26.142848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:25:26.143234 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:25:26.143588 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:25:26.173869 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:25:26.174406 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:25:26.174756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:26.186701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:25:26.187208 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:25:26.187560 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:25:26.189585 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:25:26.207217 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:25:26.207714 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:25:26.210331 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.002 seconds
[0m16:25:26.216837 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:25:26.218881 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:25:26.219288 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:25:26.219630 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:25:26.224283 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:25:26.225315 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:25:26.225938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e7110>]}
[0m16:25:26.226543 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.08s]
[0m16:25:26.227190 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:25:26.228236 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:25:26.228852 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:25:26.229397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:25:26.229803 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:25:26.233937 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:25:26.234918 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:25:26.259227 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:25:26.260136 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:26.260510 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:25:26.260829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:26.275184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:25:26.275675 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:26.276045 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:25:26.279837 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:25:26.286971 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:26.287469 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:25:26.288727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:26.291508 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:26.291895 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:25:26.293175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:26.294796 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:25:26.295174 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:26.295500 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:25:26.299081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:25:26.301692 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:25:26.304868 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:25:26.305302 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:25:26.309417 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:25:26.310906 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:25:26.311504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11205b330>]}
[0m16:25:26.312196 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:25:26.312844 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:25:26.313696 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:25:26.314304 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:25:26.314814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:25:26.315173 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:25:26.317969 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:25:26.319458 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:25:26.324183 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:25:26.325431 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:26.325930 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:25:26.326275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:26.339150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:25:26.339684 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:26.340155 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:25:26.418736 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.078 seconds
[0m16:25:26.421854 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:26.422257 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" rename to "fact_meter_readings__dbt_backup"
[0m16:25:26.423559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:26.426272 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:26.426666 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:25:26.428059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:26.429674 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:25:26.430060 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:26.430389 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:25:26.433688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:25:26.436496 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:25:26.437255 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:25:26.437612 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:25:26.442059 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:25:26.443548 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:25:26.444130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caf2322-d5a4-4179-b073-76f845f722b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d7430>]}
[0m16:25:26.444803 [info ] [Thread-1 (]: 4 of 4 OK created sql table model vtec_dbt_test.fact_meter_readings ............ [[32mSELECT 100[0m in 0.13s]
[0m16:25:26.445450 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:25:26.446895 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:26.447309 [debug] [MainThread]: On master: BEGIN
[0m16:25:26.447601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:26.461254 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:25:26.461715 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.462070 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:26.462357 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.463157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:25:26.463579 [debug] [MainThread]: On master: Close
[0m16:25:26.464053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:26.464361 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:25:26.464736 [info ] [MainThread]: 
[0m16:25:26.465111 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m16:25:26.466345 [debug] [MainThread]: Command end result
[0m16:25:26.485044 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:25:26.487329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:25:26.493956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:25:26.494463 [info ] [MainThread]: 
[0m16:25:26.494871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:26.495194 [info ] [MainThread]: 
[0m16:25:26.495546 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:25:26.497134 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3983693, "process_in_blocks": "0", "process_kernel_time": 0.319032, "process_mem_max_rss": "117391360", "process_out_blocks": "0", "process_user_time": 2.347666}
[0m16:25:26.497625 [debug] [MainThread]: Command `dbt build` succeeded at 16:25:26.497511 after 1.40 seconds
[0m16:25:26.498070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f393d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106dfe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126a0b0>]}
[0m16:25:26.498503 [debug] [MainThread]: Flushing usage events
[0m16:25:26.750525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:56.080307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b653ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b653c50>]}


============================== 16:25:56.085449 | 56679683-ff86-4e8e-b94f-c81faa73256b ==============================
[0m16:25:56.085449 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:25:56.086102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select stg_postgres__meter_readings.sql --vars {is_test_run:false}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:56.268645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56679683-ff86-4e8e-b94f-c81faa73256b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb91ba0>]}
[0m16:25:56.330940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56679683-ff86-4e8e-b94f-c81faa73256b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5e5480>]}
[0m16:25:56.332095 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:25:56.433307 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:25:56.557843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:56.558299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:56.603208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56679683-ff86-4e8e-b94f-c81faa73256b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b76c850>]}
[0m16:25:56.686439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:25:56.691366 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:25:56.733430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56679683-ff86-4e8e-b94f-c81faa73256b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b2990>]}
[0m16:25:56.733951 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:25:56.736090 [info ] [MainThread]: 
[0m16:25:56.736526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:56.736830 [info ] [MainThread]: 
[0m16:25:56.737353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:56.738211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:25:56.797897 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:25:56.798324 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:25:56.798665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:56.827017 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.028 seconds
[0m16:25:56.828502 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:25:56.833692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:25:56.839168 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:25:56.839567 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:25:56.839884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:56.851875 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:25:56.852337 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:25:56.852677 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:25:56.855883 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m16:25:56.857512 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:25:56.858450 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:25:56.863476 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:56.863898 [debug] [MainThread]: On master: BEGIN
[0m16:25:56.864179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:56.875468 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:25:56.876001 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:56.876373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:56.880775 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m16:25:56.882179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56679683-ff86-4e8e-b94f-c81faa73256b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c517d90>]}
[0m16:25:56.882700 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:56.883573 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:56.883957 [debug] [MainThread]: On master: BEGIN
[0m16:25:56.885158 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:25:56.885549 [debug] [MainThread]: On master: COMMIT
[0m16:25:56.885853 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:56.886120 [debug] [MainThread]: On master: COMMIT
[0m16:25:56.886808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:25:56.887180 [debug] [MainThread]: On master: Close
[0m16:25:56.889343 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:56.890103 [info ] [Thread-1 (]: 1 of 1 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:25:56.890629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:25:56.891020 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:56.904131 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:56.905093 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:56.943123 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:56.944134 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:56.944539 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:25:56.944892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:56.957738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:25:56.958228 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:56.958619 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:25:56.961676 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:25:56.968130 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:56.968597 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:25:56.970119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:56.972896 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:56.973709 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:25:56.975173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:25:56.991854 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:25:56.992370 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:56.992729 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:25:56.997231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:25:57.003574 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:25:57.009116 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:25:57.009606 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:25:57.014331 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:25:57.017007 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:25:57.018962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56679683-ff86-4e8e-b94f-c81faa73256b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca521a0>]}
[0m16:25:57.019877 [info ] [Thread-1 (]: 1 of 1 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.13s]
[0m16:25:57.020599 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:25:57.021876 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:57.022225 [debug] [MainThread]: On master: BEGIN
[0m16:25:57.022514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:57.035757 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:25:57.036218 [debug] [MainThread]: On master: COMMIT
[0m16:25:57.036543 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:57.036855 [debug] [MainThread]: On master: COMMIT
[0m16:25:57.037715 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:25:57.038091 [debug] [MainThread]: On master: Close
[0m16:25:57.038554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:57.038891 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m16:25:57.039241 [info ] [MainThread]: 
[0m16:25:57.039685 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m16:25:57.040573 [debug] [MainThread]: Command end result
[0m16:25:57.060985 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:25:57.062844 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:25:57.071391 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:25:57.071871 [info ] [MainThread]: 
[0m16:25:57.072310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:57.072623 [info ] [MainThread]: 
[0m16:25:57.072954 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:25:57.074502 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0726511, "process_in_blocks": "0", "process_kernel_time": 0.314518, "process_mem_max_rss": "115691520", "process_out_blocks": "0", "process_user_time": 2.228797}
[0m16:25:57.074978 [debug] [MainThread]: Command `dbt build` succeeded at 16:25:57.074865 after 1.07 seconds
[0m16:25:57.075385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b555cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5e2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5e2fc0>]}
[0m16:25:57.075747 [debug] [MainThread]: Flushing usage events
[0m16:25:57.421189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:44.194096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e50e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8bfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8bfc50>]}


============================== 16:29:44.200678 | 2caeccde-71ce-4db7-87ee-c59d69abd19f ==============================
[0m16:29:44.200678 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:29:44.201378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select stg_postgres__meter_readings --vars {is_test_run:false}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:44.402468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2caeccde-71ce-4db7-87ee-c59d69abd19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdfdba0>]}
[0m16:29:44.466679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2caeccde-71ce-4db7-87ee-c59d69abd19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f851480>]}
[0m16:29:44.468025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:29:44.581847 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:29:44.749684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:44.750129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:44.795352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2caeccde-71ce-4db7-87ee-c59d69abd19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9d8850>]}
[0m16:29:44.873219 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:29:44.876706 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:29:44.925689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2caeccde-71ce-4db7-87ee-c59d69abd19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa22990>]}
[0m16:29:44.926279 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:29:44.928122 [info ] [MainThread]: 
[0m16:29:44.928559 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:44.928869 [info ] [MainThread]: 
[0m16:29:44.929402 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:44.930299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:29:45.012970 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:29:45.013443 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:29:45.013772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:45.045392 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.032 seconds
[0m16:29:45.046898 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:29:45.051788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:29:45.057520 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:29:45.057945 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:29:45.058245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:45.072040 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m16:29:45.072507 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:29:45.072854 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:29:45.076657 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m16:29:45.078159 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:29:45.079261 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:29:45.084245 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:45.084711 [debug] [MainThread]: On master: BEGIN
[0m16:29:45.085034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:45.096324 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:29:45.096778 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:45.097142 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:45.100870 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m16:29:45.102206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2caeccde-71ce-4db7-87ee-c59d69abd19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110783d90>]}
[0m16:29:45.102684 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:45.103609 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:45.104040 [debug] [MainThread]: On master: BEGIN
[0m16:29:45.105441 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:29:45.105856 [debug] [MainThread]: On master: COMMIT
[0m16:29:45.106172 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:45.106444 [debug] [MainThread]: On master: COMMIT
[0m16:29:45.107205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:29:45.107533 [debug] [MainThread]: On master: Close
[0m16:29:45.110915 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:29:45.111545 [info ] [Thread-1 (]: 1 of 1 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:29:45.112043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:29:45.112435 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:29:45.127258 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:45.137655 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:29:45.176868 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:45.177919 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:45.178309 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:29:45.178632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:45.191475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:29:45.192048 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:45.192422 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:29:45.195397 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:29:45.201704 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:45.202193 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:29:45.203764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:29:45.207064 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:45.208039 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:29:45.209808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:29:45.229203 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:29:45.229729 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:45.230134 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:29:45.234902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:29:45.241620 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:29:45.247629 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:45.248277 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:29:45.252378 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:29:45.255107 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:29:45.257480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2caeccde-71ce-4db7-87ee-c59d69abd19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cc21a0>]}
[0m16:29:45.258434 [info ] [Thread-1 (]: 1 of 1 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.14s]
[0m16:29:45.259943 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:29:45.261557 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:45.261996 [debug] [MainThread]: On master: BEGIN
[0m16:29:45.262336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:45.276253 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:29:45.277509 [debug] [MainThread]: On master: COMMIT
[0m16:29:45.278793 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:45.279395 [debug] [MainThread]: On master: COMMIT
[0m16:29:45.280741 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:29:45.281211 [debug] [MainThread]: On master: Close
[0m16:29:45.281711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:45.282071 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_postgres__meter_readings' was properly closed.
[0m16:29:45.282414 [info ] [MainThread]: 
[0m16:29:45.282784 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m16:29:45.283572 [debug] [MainThread]: Command end result
[0m16:29:45.307532 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:29:45.309703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:29:45.317392 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:29:45.317847 [info ] [MainThread]: 
[0m16:29:45.318259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:45.318696 [info ] [MainThread]: 
[0m16:29:45.319447 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:29:45.322615 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2185768, "process_in_blocks": "0", "process_kernel_time": 0.445234, "process_mem_max_rss": "115556352", "process_out_blocks": "0", "process_user_time": 2.313733}
[0m16:29:45.323365 [debug] [MainThread]: Command `dbt build` succeeded at 16:29:45.323140 after 1.22 seconds
[0m16:29:45.324590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7c1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084efc0>]}
[0m16:29:45.325237 [debug] [MainThread]: Flushing usage events
[0m16:29:45.609092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:58.692302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ea270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669bc50>]}


============================== 16:29:58.697272 | ede793fc-8ca6-4435-b6eb-dfc543271b0a ==============================
[0m16:29:58.697272 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:29:58.697929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --vars {is_test_run:false}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:29:58.873995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd1ba0>]}
[0m16:29:58.933626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106629480>]}
[0m16:29:58.934618 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:29:59.034055 [debug] [MainThread]: checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5, vars: {'is_test_run:false': None}, profile: , target: , version: 1.9.4
[0m16:29:59.158461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:59.158901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:59.204685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b34850>]}
[0m16:29:59.285626 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:29:59.288902 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:29:59.316878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7e990>]}
[0m16:29:59.317405 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:29:59.319621 [info ] [MainThread]: 
[0m16:29:59.320080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:59.320398 [info ] [MainThread]: 
[0m16:29:59.320910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:59.326121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:29:59.382248 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:29:59.383470 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:29:59.384748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:59.412038 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.027 seconds
[0m16:29:59.413580 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:29:59.415121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:29:59.420964 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:29:59.421390 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:29:59.421690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:59.433397 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:29:59.433865 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:29:59.434220 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:29:59.437750 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m16:29:59.439307 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:29:59.440276 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:29:59.445432 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:59.445906 [debug] [MainThread]: On master: BEGIN
[0m16:29:59.446390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:59.459191 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:29:59.459637 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:59.460049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:59.465025 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:29:59.466550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756bd90>]}
[0m16:29:59.467069 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:59.468109 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:59.468472 [debug] [MainThread]: On master: BEGIN
[0m16:29:59.469532 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:29:59.469932 [debug] [MainThread]: On master: COMMIT
[0m16:29:59.470250 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:59.470535 [debug] [MainThread]: On master: COMMIT
[0m16:29:59.471340 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:29:59.471755 [debug] [MainThread]: On master: Close
[0m16:29:59.474024 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:29:59.474728 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:29:59.475253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:29:59.475631 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:29:59.489163 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:59.490034 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:29:59.528660 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:59.529641 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:59.530029 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:29:59.530358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:59.545459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:29:59.545984 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:59.546366 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100


  );
[0m16:29:59.549001 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:29:59.555390 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:59.555841 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:29:59.557311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:29:59.560023 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:59.560810 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:29:59.562375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:29:59.580090 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:29:59.590527 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:59.591366 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:29:59.596394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:29:59.603514 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:29:59.608743 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:29:59.609166 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:29:59.613790 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:29:59.616359 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:29:59.618447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abe000>]}
[0m16:29:59.619354 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.14s]
[0m16:29:59.620055 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:29:59.620476 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:29:59.620935 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:29:59.621396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:29:59.621869 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:29:59.622272 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:29:59.653084 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:29:59.653550 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:29:59.653888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:59.665743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:29:59.666286 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:29:59.666688 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:29:59.669957 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m16:29:59.687692 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:29:59.688173 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:29:59.689865 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:29:59.695935 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:29:59.698552 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:29:59.699008 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:29:59.699376 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:29:59.710060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:29:59.711044 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:29:59.711771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076531d0>]}
[0m16:29:59.712606 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.09s]
[0m16:29:59.713443 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:29:59.714672 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:29:59.715277 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:29:59.715827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:29:59.716226 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:29:59.720748 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:29:59.721945 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:29:59.747722 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:29:59.748667 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:29:59.749264 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:29:59.750066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:59.763656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:29:59.764180 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:29:59.764577 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:29:59.768808 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m16:29:59.776012 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:29:59.776538 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:29:59.777919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:29:59.780769 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:29:59.781177 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:29:59.782599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:29:59.784582 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:29:59.785020 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:29:59.785378 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:29:59.831181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m16:29:59.834118 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:29:59.837221 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:29:59.837661 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:29:59.842173 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:29:59.843719 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:29:59.844346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107637ee0>]}
[0m16:29:59.845044 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.13s]
[0m16:29:59.845684 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:29:59.846793 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:29:59.847385 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:29:59.847884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:29:59.848259 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:29:59.851362 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:29:59.853088 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:29:59.857601 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:29:59.858471 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:29:59.859002 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:29:59.859439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:59.871023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:29:59.871521 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:29:59.871914 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:29:59.958466 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.086 seconds
[0m16:29:59.961385 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:29:59.961770 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" rename to "fact_meter_readings__dbt_backup"
[0m16:29:59.963094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:29:59.965747 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:29:59.966125 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:29:59.967462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:29:59.969060 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:29:59.969432 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:29:59.969770 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:29:59.973999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:29:59.976626 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:29:59.977366 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:29:59.977714 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:29:59.982875 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:29:59.984344 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:29:59.984927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede793fc-8ca6-4435-b6eb-dfc543271b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3af30>]}
[0m16:29:59.985617 [info ] [Thread-1 (]: 4 of 4 OK created sql table model vtec_dbt_test.fact_meter_readings ............ [[32mSELECT 100[0m in 0.14s]
[0m16:29:59.986240 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:29:59.987716 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:59.988201 [debug] [MainThread]: On master: BEGIN
[0m16:29:59.988517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:00.002612 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:30:00.003169 [debug] [MainThread]: On master: COMMIT
[0m16:30:00.003564 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:00.003894 [debug] [MainThread]: On master: COMMIT
[0m16:30:00.005156 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:30:00.005614 [debug] [MainThread]: On master: Close
[0m16:30:00.006086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:00.006402 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:30:00.006795 [info ] [MainThread]: 
[0m16:30:00.007189 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m16:30:00.008509 [debug] [MainThread]: Command end result
[0m16:30:00.028474 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:30:00.030316 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:30:00.037393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:30:00.037795 [info ] [MainThread]: 
[0m16:30:00.038242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:00.038911 [info ] [MainThread]: 
[0m16:30:00.039641 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:30:00.041511 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4310914, "process_in_blocks": "0", "process_kernel_time": 0.350756, "process_mem_max_rss": "116817920", "process_out_blocks": "0", "process_user_time": 2.367375}
[0m16:30:00.042151 [debug] [MainThread]: Command `dbt build` succeeded at 16:30:00.042010 after 1.43 seconds
[0m16:30:00.042570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066da0b0>]}
[0m16:30:00.042936 [debug] [MainThread]: Flushing usage events
[0m16:30:00.318984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:07.273469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d622270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9dbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9dbc50>]}


============================== 16:30:07.278456 | de79f4ed-d3c7-4803-8a25-3a3d1a4d7186 ==============================
[0m16:30:07.278456 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:30:07.279093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --vars {is_test_run: false}', 'send_anonymous_usage_stats': 'True'}
[0m16:30:07.455255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef19ba0>]}
[0m16:30:07.517767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e969480>]}
[0m16:30:07.518794 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:07.620157 [debug] [MainThread]: checksum: f2035a19be75432734c410735a0df8a8d9b719fc7847ba47f17e4cc4a8ea5718, vars: {'is_test_run': False}, profile: , target: , version: 1.9.4
[0m16:30:07.721859 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:30:07.722399 [debug] [MainThread]: previous checksum: f2035a19be75432734c410735a0df8a8d9b719fc7847ba47f17e4cc4a8ea5718, current checksum: 84beee6e093328442065340a372f84c5534cbf02adbaa2796f5bb4849f1c13a5
[0m16:30:07.722835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf3450>]}
[0m16:30:08.990257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8c75c0>]}
[0m16:30:09.065048 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:30:09.067999 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:30:09.095550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa6f3f0>]}
[0m16:30:09.096058 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:30:09.098229 [info ] [MainThread]: 
[0m16:30:09.098654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:09.099012 [info ] [MainThread]: 
[0m16:30:09.099511 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:09.104458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:30:09.152967 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:30:09.153472 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:30:09.153808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:09.181068 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.027 seconds
[0m16:30:09.182507 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:30:09.184019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:30:09.189755 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:30:09.190215 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:30:09.190520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:09.201908 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:30:09.202345 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:30:09.202664 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:30:09.205788 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m16:30:09.207330 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:30:09.208267 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:30:09.213503 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:09.213927 [debug] [MainThread]: On master: BEGIN
[0m16:30:09.214228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:09.225678 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:30:09.226169 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:09.226595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:09.230611 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m16:30:09.231971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdaf110>]}
[0m16:30:09.232442 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:09.233360 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:09.233705 [debug] [MainThread]: On master: BEGIN
[0m16:30:09.235102 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:30:09.235480 [debug] [MainThread]: On master: COMMIT
[0m16:30:09.235778 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:09.236078 [debug] [MainThread]: On master: COMMIT
[0m16:30:09.236921 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:30:09.237251 [debug] [MainThread]: On master: Close
[0m16:30:09.239833 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:30:09.240846 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:30:09.242713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:30:09.243565 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:30:09.259096 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:30:09.259994 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:30:09.296681 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:30:09.297677 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:30:09.298101 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:30:09.298442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:09.311556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:30:09.312158 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:30:09.312576 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'

  );
[0m16:30:09.315447 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:30:09.321562 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:30:09.322048 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:30:09.323639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:09.330097 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:30:09.330612 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:30:09.332165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:09.349450 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:30:09.349935 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:30:09.350286 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:30:09.354753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:30:09.360985 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:30:09.366679 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:30:09.367178 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:30:09.372109 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:30:09.374638 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:30:09.376493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fadfa10>]}
[0m16:30:09.377392 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.13s]
[0m16:30:09.378124 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:30:09.378549 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:30:09.379020 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:30:09.379586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:30:09.380019 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:30:09.380389 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:30:09.410470 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:30:09.410963 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:30:09.411308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:09.422665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:30:09.423207 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:30:09.423571 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:30:09.425313 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m16:30:09.443913 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:30:09.444485 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:30:09.446009 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:30:09.452143 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:30:09.454277 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:30:09.454754 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:30:09.455147 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:30:09.460965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:30:09.461893 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:30:09.462505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faf7ee0>]}
[0m16:30:09.463211 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.08s]
[0m16:30:09.463956 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:30:09.464932 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:30:09.465588 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:30:09.466108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:30:09.466455 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:30:09.469652 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:30:09.471089 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:30:09.495597 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:30:09.496769 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:30:09.497419 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:30:09.497954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:09.509695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:30:09.510194 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:30:09.510564 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:30:09.513234 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m16:30:09.519607 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:30:09.520016 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:30:09.521289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:09.524319 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:30:09.524749 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:30:09.526204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:09.527920 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:30:09.528318 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:30:09.528648 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:30:09.532547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:30:09.535684 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:30:09.539271 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:30:09.539799 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:30:09.544445 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:30:09.545960 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:30:09.546649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc300f0>]}
[0m16:30:09.547390 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:30:09.548022 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:30:09.548893 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:30:09.549503 [info ] [Thread-1 (]: 4 of 4 START sql table model vtec_dbt_test.fact_meter_readings ................. [RUN]
[0m16:30:09.550012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:30:09.550371 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:30:09.553211 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:30:09.554704 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:30:09.559091 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:30:09.560258 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:30:09.561042 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:30:09.561783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:09.573571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:30:09.574082 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:30:09.574470 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address
where meter_type = 'EKM'
  );
  
[0m16:30:10.199176 [debug] [Thread-1 (]: SQL status: SELECT 217991 in 0.624 seconds
[0m16:30:10.202282 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:30:10.202686 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" rename to "fact_meter_readings__dbt_backup"
[0m16:30:10.203939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:10.206651 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:30:10.207040 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:30:10.208270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:10.209939 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:30:10.210350 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:30:10.210690 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:30:10.245999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m16:30:10.249186 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:30:10.250124 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:30:10.250578 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:30:10.254950 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:30:10.256481 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:30:10.257529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de79f4ed-d3c7-4803-8a25-3a3d1a4d7186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fef03d0>]}
[0m16:30:10.259771 [info ] [Thread-1 (]: 4 of 4 OK created sql table model vtec_dbt_test.fact_meter_readings ............ [[32mSELECT 217991[0m in 0.71s]
[0m16:30:10.262010 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:30:10.264540 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:10.265651 [debug] [MainThread]: On master: BEGIN
[0m16:30:10.266290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:10.287964 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m16:30:10.288554 [debug] [MainThread]: On master: COMMIT
[0m16:30:10.288936 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:10.289448 [debug] [MainThread]: On master: COMMIT
[0m16:30:10.291104 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:30:10.291790 [debug] [MainThread]: On master: Close
[0m16:30:10.292357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:10.293034 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:30:10.293945 [info ] [MainThread]: 
[0m16:30:10.294703 [info ] [MainThread]: Finished running 1 seed, 2 table models, 1 view model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m16:30:10.296015 [debug] [MainThread]: Command end result
[0m16:30:10.316115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:30:10.318527 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:30:10.325612 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:30:10.326304 [info ] [MainThread]: 
[0m16:30:10.327193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:10.327996 [info ] [MainThread]: 
[0m16:30:10.328459 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:30:10.330015 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.1353617, "process_in_blocks": "0", "process_kernel_time": 0.327419, "process_mem_max_rss": "121712640", "process_out_blocks": "0", "process_user_time": 3.518021}
[0m16:30:10.330495 [debug] [MainThread]: Command `dbt build` succeeded at 16:30:10.330384 after 3.14 seconds
[0m16:30:10.330873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea1a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a789d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f6ab0>]}
[0m16:30:10.331270 [debug] [MainThread]: Flushing usage events
[0m16:30:10.597996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:14.780614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103932270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb3c50>]}


============================== 16:38:14.787489 | d256cc1a-010b-4a6a-9b4f-588b369b9a5b ==============================
[0m16:38:14.787489 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:38:14.788151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --vars {is_test_run: false}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:38:15.010602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e9ba0>]}
[0m16:38:15.073450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c45480>]}
[0m16:38:15.074998 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:15.190082 [debug] [MainThread]: checksum: f2035a19be75432734c410735a0df8a8d9b719fc7847ba47f17e4cc4a8ea5718, vars: {'is_test_run': False}, profile: , target: , version: 1.9.4
[0m16:38:15.297229 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:38:15.297750 [debug] [MainThread]: previous checksum: f2035a19be75432734c410735a0df8a8d9b719fc7847ba47f17e4cc4a8ea5718, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m16:38:15.298265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514f450>]}
[0m16:38:16.580212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101bcb5c0>]}
[0m16:38:16.654291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:38:16.658004 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:38:16.709686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0f070>]}
[0m16:38:16.710201 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:38:16.712379 [info ] [MainThread]: 
[0m16:38:16.712814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:16.713124 [info ] [MainThread]: 
[0m16:38:16.713606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:16.718093 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:38:16.785878 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:38:16.786333 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:38:16.786665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:16.825365 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.038 seconds
[0m16:38:16.884774 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:38:16.889335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:38:16.898803 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:38:16.899264 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:38:16.899598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:16.927955 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m16:38:16.928661 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:38:16.929330 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:38:16.936552 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m16:38:16.939447 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:38:16.941862 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:38:16.951846 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:16.952858 [debug] [MainThread]: On master: BEGIN
[0m16:38:16.953501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:16.968624 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:38:16.969074 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:16.969521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:16.974829 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:38:16.976367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607f2b0>]}
[0m16:38:16.976912 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:16.978119 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:16.978530 [debug] [MainThread]: On master: BEGIN
[0m16:38:16.979790 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:38:16.980189 [debug] [MainThread]: On master: COMMIT
[0m16:38:16.980488 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:16.980750 [debug] [MainThread]: On master: COMMIT
[0m16:38:16.981535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:16.981941 [debug] [MainThread]: On master: Close
[0m16:38:16.985537 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:16.986164 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:38:16.987291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:38:16.987698 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:16.997726 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:16.999805 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:17.042133 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:17.043629 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:17.044049 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:38:17.044386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:17.057774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:38:17.058294 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:17.058706 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'

  );
[0m16:38:17.062625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:38:17.069037 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:17.069514 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:38:17.070997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:17.074169 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:17.074572 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:38:17.075839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:17.092962 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:38:17.093482 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:17.093835 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:38:17.098700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:38:17.104832 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:38:17.110606 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:17.111086 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:38:17.115353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:38:17.117933 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:38:17.120122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbba10>]}
[0m16:38:17.120991 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.13s]
[0m16:38:17.121676 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:17.122102 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:38:17.122654 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:38:17.123139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:38:17.123497 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:38:17.123832 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:38:17.153851 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:17.154478 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:38:17.154863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:17.167229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:38:17.167712 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:17.168062 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:38:17.170271 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:38:17.188555 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:17.189043 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:38:17.190667 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:38:17.197411 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:38:17.200037 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:38:17.200471 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:17.200826 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:38:17.205739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:38:17.206683 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:38:17.207294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621ce10>]}
[0m16:38:17.207882 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.08s]
[0m16:38:17.208607 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:38:17.209796 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:38:17.210451 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:38:17.211016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:38:17.211431 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:38:17.215787 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:38:17.217671 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:38:17.241089 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:38:17.242081 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:17.242478 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:38:17.242801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:17.255038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:38:17.255527 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:17.255882 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:38:17.259636 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:38:17.266414 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:17.266944 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:38:17.268233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:17.271258 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:17.271671 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:38:17.272903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:17.274555 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:38:17.274943 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:17.275274 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:38:17.279097 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:17.281696 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:38:17.284651 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:17.285089 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:38:17.289378 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:38:17.290873 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:38:17.291468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106342210>]}
[0m16:38:17.292164 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:38:17.292820 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:38:17.293630 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:38:17.294372 [info ] [Thread-1 (]: 4 of 4 START sql incremental model vtec_dbt_test.fact_meter_readings ........... [RUN]
[0m16:38:17.294927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:38:17.295307 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:38:17.299439 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:38:17.301570 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:38:17.335056 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:17.335569 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

    
  
    

  create temporary table "fact_meter_readings__dbt_tmp163817329159"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh,
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address

  where end_date_time > (select max(end_date_time) from "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings")

  );
  
  
[0m16:38:17.335961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:17.348107 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 30: from ekm_meter_readings
         ^

[0m16:38:17.348740 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:38:17.363286 [debug] [Thread-1 (]: Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  syntax error at or near "from"
  LINE 30: from ekm_meter_readings
           ^
[0m16:38:17.363859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256cc1a-010b-4a6a-9b4f-588b369b9a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b28d0>]}
[0m16:38:17.364485 [error] [Thread-1 (]: 4 of 4 ERROR creating sql incremental model vtec_dbt_test.fact_meter_readings .. [[31mERROR[0m in 0.07s]
[0m16:38:17.365254 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:38:17.365836 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.fact_meter_readings' to be skipped because of status 'error'.  Reason: Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  syntax error at or near "from"
  LINE 30: from ekm_meter_readings
           ^.
[0m16:38:17.367322 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:17.367664 [debug] [MainThread]: On master: BEGIN
[0m16:38:17.367943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:17.382572 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:38:17.383214 [debug] [MainThread]: On master: COMMIT
[0m16:38:17.383659 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:17.384097 [debug] [MainThread]: On master: COMMIT
[0m16:38:17.385216 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:38:17.385695 [debug] [MainThread]: On master: Close
[0m16:38:17.386237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:17.386596 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:38:17.386943 [info ] [MainThread]: 
[0m16:38:17.387297 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 1 table model, 1 view model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m16:38:17.388514 [debug] [MainThread]: Command end result
[0m16:38:17.409509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:38:17.411243 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:38:17.418590 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:38:17.418994 [info ] [MainThread]: 
[0m16:38:17.419451 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:17.419933 [info ] [MainThread]: 
[0m16:38:17.420545 [error] [MainThread]:   Database Error in model fact_meter_readings (models/core/fact_meter_readings.sql)
  syntax error at or near "from"
  LINE 30: from ekm_meter_readings
           ^
[0m16:38:17.421273 [info ] [MainThread]: 
[0m16:38:17.421676 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:38:17.424352 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.7232995, "process_in_blocks": "0", "process_kernel_time": 0.47513, "process_mem_max_rss": "123011072", "process_out_blocks": "0", "process_user_time": 3.691454}
[0m16:38:17.424928 [debug] [MainThread]: Command `dbt build` failed at 16:38:17.424794 after 2.72 seconds
[0m16:38:17.425339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf20b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a81d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a1c70>]}
[0m16:38:17.425735 [debug] [MainThread]: Flushing usage events
[0m16:38:17.760737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:33.595386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fee6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b3c50>]}


============================== 16:38:33.600277 | 48bf9ef6-0569-456e-a09a-f281fa78efd8 ==============================
[0m16:38:33.600277 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:38:33.601023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --vars {is_test_run: false}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:38:33.770908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e9ba0>]}
[0m16:38:33.837282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111241480>]}
[0m16:38:33.838333 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:33.938645 [debug] [MainThread]: checksum: f2035a19be75432734c410735a0df8a8d9b719fc7847ba47f17e4cc4a8ea5718, vars: {'is_test_run': False}, profile: , target: , version: 1.9.4
[0m16:38:34.042626 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:38:34.043179 [debug] [MainThread]: previous checksum: f2035a19be75432734c410735a0df8a8d9b719fc7847ba47f17e4cc4a8ea5718, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m16:38:34.043575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111753450>]}
[0m16:38:35.269223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1e35c0>]}
[0m16:38:35.342724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:38:35.346367 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:38:35.374224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11230f070>]}
[0m16:38:35.374781 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:38:35.376917 [info ] [MainThread]: 
[0m16:38:35.377310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:35.377614 [info ] [MainThread]: 
[0m16:38:35.378096 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:35.383419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:38:35.453416 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:38:35.453949 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:38:35.454501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:35.485130 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m16:38:35.486637 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:38:35.488201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:38:35.493898 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:38:35.494327 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:38:35.494629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:35.505986 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.506439 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:38:35.506780 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:38:35.511219 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m16:38:35.512655 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:38:35.513532 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:38:35.518729 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.519252 [debug] [MainThread]: On master: BEGIN
[0m16:38:35.519562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:35.537963 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:38:35.538426 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.538855 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:35.543856 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:38:35.545219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11267f2b0>]}
[0m16:38:35.545695 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:35.546574 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.546971 [debug] [MainThread]: On master: BEGIN
[0m16:38:35.548170 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:38:35.548567 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.548883 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.549159 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.549865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:35.550224 [debug] [MainThread]: On master: Close
[0m16:38:35.552725 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:35.553378 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:38:35.554522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:38:35.554963 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:35.565134 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:35.566546 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:35.607984 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:35.608973 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:35.609372 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:38:35.609701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.623094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:38:35.623603 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:35.623991 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'

  );
[0m16:38:35.626808 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:38:35.632977 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:35.633443 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:38:35.635028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:35.638326 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:35.638767 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:38:35.640121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:35.657129 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:38:35.657679 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:35.658050 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:38:35.682913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m16:38:35.691239 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:38:35.697367 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:35.697824 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:38:35.702492 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:38:35.705066 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:38:35.706964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123bba10>]}
[0m16:38:35.707758 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.15s]
[0m16:38:35.708503 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:35.708936 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:38:35.709515 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:38:35.710030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:38:35.710403 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:38:35.710764 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:38:35.740648 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:35.741128 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:38:35.741471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.754213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:38:35.754743 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:35.755115 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
truncate table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:38:35.757222 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:38:35.775855 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:35.776349 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:38:35.778040 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:38:35.784793 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:38:35.787140 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:38:35.787611 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:35.787983 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:38:35.793929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:38:35.794893 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:38:35.795583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112818e10>]}
[0m16:38:35.796297 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mINSERT 3[0m in 0.09s]
[0m16:38:35.797208 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:38:35.799291 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:38:35.800505 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:38:35.801240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:38:35.801705 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:38:35.806127 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:38:35.807106 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:38:35.830655 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:38:35.831645 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:35.832034 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:38:35.832361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.846230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:38:35.846723 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:35.847089 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:38:35.850016 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:35.856984 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:35.857503 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:38:35.858901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:35.861620 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:35.862013 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:38:35.863165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:35.864797 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:38:35.865174 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:35.865509 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:38:35.868737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:35.871661 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:38:35.874671 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:35.875078 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:38:35.878992 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:38:35.880507 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:38:35.881102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112942210>]}
[0m16:38:35.881815 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:38:35.882442 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:38:35.883278 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:38:35.883960 [info ] [Thread-1 (]: 4 of 4 START sql incremental model vtec_dbt_test.fact_meter_readings ........... [RUN]
[0m16:38:35.884564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:38:35.884960 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:38:35.889004 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:38:35.890328 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:38:35.923837 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:35.924368 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

    
  
    

  create temporary table "fact_meter_readings__dbt_tmp163835917406"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address

  where end_date_time > (select max(end_date_time) from "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings")

  );
  
  
[0m16:38:35.924753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:36.215924 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.291 seconds
[0m16:38:36.229054 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:36.229565 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:38:36.231180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:38:36.231668 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:36.232031 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_meter_readings__dbt_tmp163835917406'
        
      order by ordinal_position

  
[0m16:38:36.245945 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.013 seconds
[0m16:38:36.251175 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:36.251614 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres-zoomcamp".INFORMATION_SCHEMA.columns
      where table_name = 'fact_meter_readings'
        
        and table_schema = 'vtec_dbt_test'
        
      order by ordinal_position

  
[0m16:38:36.255082 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m16:38:36.263388 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:36.263862 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres-zoomcamp".INFORMATION_SCHEMA.columns
      where table_name = 'fact_meter_readings'
        
        and table_schema = 'vtec_dbt_test'
        
      order by ordinal_position

  
[0m16:38:36.267371 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m16:38:36.278955 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:38:36.279934 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:36.280338 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

      insert into "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" ("meter_name", "meter_type", "start_date_time", "end_date_time", "total_usage_kwh")
    (
        select "meter_name", "meter_type", "start_date_time", "end_date_time", "total_usage_kwh"
        from "fact_meter_readings__dbt_tmp163835917406"
    )


  
[0m16:38:36.281841 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:38:36.283406 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:38:36.283798 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:36.284129 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:38:36.287989 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:36.288917 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:38:36.289580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48bf9ef6-0569-456e-a09a-f281fa78efd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127ae0d0>]}
[0m16:38:36.290389 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model vtec_dbt_test.fact_meter_readings ...... [[32mINSERT 0 0[0m in 0.40s]
[0m16:38:36.291243 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:38:36.292612 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:36.293157 [debug] [MainThread]: On master: BEGIN
[0m16:38:36.293511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:36.316676 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m16:38:36.317450 [debug] [MainThread]: On master: COMMIT
[0m16:38:36.318264 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:36.318591 [debug] [MainThread]: On master: COMMIT
[0m16:38:36.319983 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:38:36.320419 [debug] [MainThread]: On master: Close
[0m16:38:36.320932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:36.321244 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:38:36.321574 [info ] [MainThread]: 
[0m16:38:36.321908 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 1 table model, 1 view model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m16:38:36.323179 [debug] [MainThread]: Command end result
[0m16:38:36.344528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:38:36.346407 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:38:36.353114 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:38:36.353587 [info ] [MainThread]: 
[0m16:38:36.354009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:36.354588 [info ] [MainThread]: 
[0m16:38:36.355233 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:38:36.357286 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.842574, "process_in_blocks": "0", "process_kernel_time": 0.335983, "process_mem_max_rss": "121974784", "process_out_blocks": "0", "process_user_time": 3.563073}
[0m16:38:36.357876 [debug] [MainThread]: Command `dbt build` succeeded at 16:38:36.357748 after 2.84 seconds
[0m16:38:36.358287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f20b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d091d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eea9a90>]}
[0m16:38:36.358679 [debug] [MainThread]: Flushing usage events
[0m16:38:36.613769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:47.202544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c422270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7dfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7dfc50>]}


============================== 16:38:47.208182 | 4f695065-a56e-4c5c-8339-f050b06e2c11 ==============================
[0m16:38:47.208182 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:38:47.209378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --vars {is_test_run: false} --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:47.403201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd19ba0>]}
[0m16:38:47.468126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d76d480>]}
[0m16:38:47.469210 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:47.574410 [debug] [MainThread]: checksum: f2035a19be75432734c410735a0df8a8d9b719fc7847ba47f17e4cc4a8ea5718, vars: {'is_test_run': False}, profile: , target: , version: 1.9.4
[0m16:38:47.703374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:47.703849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:47.752992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8f4850>]}
[0m16:38:47.852337 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:38:47.855757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:38:47.887219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93e990>]}
[0m16:38:47.887759 [info ] [MainThread]: Found 3 models, 1 seed, 1 source, 433 macros
[0m16:38:47.890323 [info ] [MainThread]: 
[0m16:38:47.890815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:47.891158 [info ] [MainThread]: 
[0m16:38:47.891728 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:47.897480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres-zoomcamp'
[0m16:38:47.956652 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp"
[0m16:38:47.957127 [debug] [ThreadPool]: On list_postgres-zoomcamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp"} */

    select distinct nspname from pg_namespace
  
[0m16:38:47.957464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:47.984058 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.027 seconds
[0m16:38:47.985529 [debug] [ThreadPool]: On list_postgres-zoomcamp: Close
[0m16:38:47.987069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp, now list_postgres-zoomcamp_vtec_dbt_test)
[0m16:38:47.992836 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:38:47.993251 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: BEGIN
[0m16:38:47.993544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:48.005760 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:38:48.006214 [debug] [ThreadPool]: Using postgres connection "list_postgres-zoomcamp_vtec_dbt_test"
[0m16:38:48.006544 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres-zoomcamp_vtec_dbt_test"} */
select
      'postgres-zoomcamp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'vtec_dbt_test'
    union all
    select
      'postgres-zoomcamp' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'vtec_dbt_test'
  
[0m16:38:48.009706 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m16:38:48.011283 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: ROLLBACK
[0m16:38:48.012384 [debug] [ThreadPool]: On list_postgres-zoomcamp_vtec_dbt_test: Close
[0m16:38:48.017437 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:48.017899 [debug] [MainThread]: On master: BEGIN
[0m16:38:48.018203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:48.031723 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:38:48.032234 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:48.032671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:48.036713 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m16:38:48.038118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e69fd90>]}
[0m16:38:48.038622 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:48.039551 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:48.039923 [debug] [MainThread]: On master: BEGIN
[0m16:38:48.041043 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:38:48.041412 [debug] [MainThread]: On master: COMMIT
[0m16:38:48.041728 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:48.042007 [debug] [MainThread]: On master: COMMIT
[0m16:38:48.042770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:48.043130 [debug] [MainThread]: On master: Close
[0m16:38:48.045516 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:48.046259 [info ] [Thread-1 (]: 1 of 4 START sql view model vtec_dbt_test.stg_postgres__meter_readings ......... [RUN]
[0m16:38:48.046849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres-zoomcamp_vtec_dbt_test, now model.jaffle_shop.stg_postgres__meter_readings)
[0m16:38:48.047260 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:48.061236 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:48.062220 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:48.100363 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:48.101363 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:48.101787 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: BEGIN
[0m16:38:48.102117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:48.114543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:38:48.115028 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:48.115406 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */

  create view "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp"
    
    
  as (
    

with meter_readings as
(
  -- This is a temporary table to hold the meter readings)
  select *,
    row_number() over(partition by meter, start_time_stamp) as rn
  from "postgres-zoomcamp"."public"."ekm_meter_data"
  where meter is not null 
)

select
    -- identifiers
    
    
    cast(meter as TEXT)
 as meter_address,
    
    -- timestamps
    cast(start_time_stamp as timestamp) as start_date_time,
    cast(end_time_stamp as timestamp) as end_date_time,
    
    -- meter info
    cast(kwh_tot_diff as numeric) as total_usage_kwh
from meter_readings
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'

  );
[0m16:38:48.118214 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:38:48.125393 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:48.142655 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings" rename to "stg_postgres__meter_readings__dbt_backup"
[0m16:38:48.145157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:48.149596 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:48.150885 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_tmp" rename to "stg_postgres__meter_readings"
[0m16:38:48.152639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:48.171826 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:38:48.172323 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:48.172683 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: COMMIT
[0m16:38:48.176468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:48.182736 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup"
[0m16:38:48.188525 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_postgres__meter_readings"
[0m16:38:48.189012 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_postgres__meter_readings"} */
drop view if exists "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings__dbt_backup" cascade
[0m16:38:48.193270 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:38:48.196000 [debug] [Thread-1 (]: On model.jaffle_shop.stg_postgres__meter_readings: Close
[0m16:38:48.197973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebda0d0>]}
[0m16:38:48.198829 [info ] [Thread-1 (]: 1 of 4 OK created sql view model vtec_dbt_test.stg_postgres__meter_readings .... [[32mCREATE VIEW[0m in 0.15s]
[0m16:38:48.199538 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_postgres__meter_readings
[0m16:38:48.199961 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.meter_name_lookup
[0m16:38:48.200533 [info ] [Thread-1 (]: 2 of 4 START seed file vtec_dbt_test.meter_name_lookup ......................... [RUN]
[0m16:38:48.201048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_postgres__meter_readings, now seed.jaffle_shop.meter_name_lookup)
[0m16:38:48.201434 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.meter_name_lookup
[0m16:38:48.201774 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.meter_name_lookup
[0m16:38:48.230957 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
[0m16:38:48.233974 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:48.234406 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" cascade
[0m16:38:48.234758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:48.248233 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m16:38:48.256604 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:48.257126 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: BEGIN
[0m16:38:48.259860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:38:48.260351 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:48.260736 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.meter_name_lookup"} */

    create table "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key" text,"meter_address" integer,"name" text)
  
[0m16:38:48.263194 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m16:38:48.280261 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:48.280750 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: 
          insert into "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup" ("meter_key", "meter_address", "name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m16:38:48.282363 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:38:48.288276 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.meter_name_lookup"
[0m16:38:48.293919 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:38:48.294407 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.meter_name_lookup"
[0m16:38:48.294824 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: COMMIT
[0m16:38:48.298513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:48.299601 [debug] [Thread-1 (]: On seed.jaffle_shop.meter_name_lookup: Close
[0m16:38:48.300368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e782450>]}
[0m16:38:48.301047 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file vtec_dbt_test.meter_name_lookup ..................... [[32mCREATE 3[0m in 0.10s]
[0m16:38:48.301743 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.meter_name_lookup
[0m16:38:48.302842 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_meters
[0m16:38:48.303619 [info ] [Thread-1 (]: 3 of 4 START sql table model vtec_dbt_test.dim_meters .......................... [RUN]
[0m16:38:48.304210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.meter_name_lookup, now model.jaffle_shop.dim_meters)
[0m16:38:48.304619 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_meters
[0m16:38:48.308028 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_meters"
[0m16:38:48.309716 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_meters
[0m16:38:48.335092 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_meters"
[0m16:38:48.336142 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:48.336628 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: BEGIN
[0m16:38:48.336996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:48.349600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:38:48.350111 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:48.350467 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */

  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp"
  
  
    as
  
  (
    

select 
    meter_key, 
    
    
    cast(meter_address as TEXT)
 as meter_address,
    name
from "postgres-zoomcamp"."vtec_dbt_test"."meter_name_lookup"
  );
  
[0m16:38:48.353228 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:48.356263 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:48.356657 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters" rename to "dim_meters__dbt_backup"
[0m16:38:48.357940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:48.361141 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:48.361734 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_tmp" rename to "dim_meters"
[0m16:38:48.363183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:48.365397 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:38:48.365866 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:48.366210 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: COMMIT
[0m16:38:48.370007 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:48.372198 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup"
[0m16:38:48.372926 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_meters"
[0m16:38:48.373273 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_meters"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."dim_meters__dbt_backup" cascade
[0m16:38:48.377280 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:38:48.378767 [debug] [Thread-1 (]: On model.jaffle_shop.dim_meters: Close
[0m16:38:48.379363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5ff330>]}
[0m16:38:48.380055 [info ] [Thread-1 (]: 3 of 4 OK created sql table model vtec_dbt_test.dim_meters ..................... [[32mSELECT 3[0m in 0.08s]
[0m16:38:48.380722 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_meters
[0m16:38:48.381611 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fact_meter_readings
[0m16:38:48.382159 [info ] [Thread-1 (]: 4 of 4 START sql incremental model vtec_dbt_test.fact_meter_readings ........... [RUN]
[0m16:38:48.382619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_meters, now model.jaffle_shop.fact_meter_readings)
[0m16:38:48.382981 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fact_meter_readings
[0m16:38:48.391114 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fact_meter_readings"
[0m16:38:48.392001 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fact_meter_readings
[0m16:38:48.423047 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fact_meter_readings"
[0m16:38:48.423995 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:48.424382 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: BEGIN
[0m16:38:48.424703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:48.436943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:38:48.437440 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:48.437816 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */

      
  
    

  create  table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp"
  
  
    as
  
  (
    

with ekm_meter_readings as (
    select *, 
        'EKM' as meter_type
    from "postgres-zoomcamp"."vtec_dbt_test"."stg_postgres__meter_readings"
), 
dim_meters as (
    select * from "postgres-zoomcamp"."vtec_dbt_test"."dim_meters"
)

select 
    dim_meters.name as meter_name,
    ekm_meter_readings.meter_type,
    ekm_meter_readings.start_date_time,
    ekm_meter_readings.end_date_time,
    ekm_meter_readings.total_usage_kwh
from ekm_meter_readings
inner join dim_meters
on ekm_meter_readings.meter_address = dim_meters.meter_address

  );
  
  
[0m16:38:49.107941 [debug] [Thread-1 (]: SQL status: SELECT 217991 in 0.670 seconds
[0m16:38:49.110913 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:49.111273 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings" rename to "fact_meter_readings__dbt_backup"
[0m16:38:49.112835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:49.115775 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:49.116180 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
alter table "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_tmp" rename to "fact_meter_readings"
[0m16:38:49.117714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:49.119226 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:38:49.119573 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:49.119875 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: COMMIT
[0m16:38:49.130455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:38:49.132582 [debug] [Thread-1 (]: Applying DROP to: "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup"
[0m16:38:49.133265 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fact_meter_readings"
[0m16:38:49.133621 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_meter_readings"} */
drop table if exists "postgres-zoomcamp"."vtec_dbt_test"."fact_meter_readings__dbt_backup" cascade
[0m16:38:49.138611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:38:49.140082 [debug] [Thread-1 (]: On model.jaffle_shop.fact_meter_readings: Close
[0m16:38:49.140662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f695065-a56e-4c5c-8339-f050b06e2c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec536b0>]}
[0m16:38:49.141342 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model vtec_dbt_test.fact_meter_readings ...... [[32mSELECT 217991[0m in 0.76s]
[0m16:38:49.141968 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fact_meter_readings
[0m16:38:49.143165 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:49.143677 [debug] [MainThread]: On master: BEGIN
[0m16:38:49.143986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:49.158039 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:38:49.158485 [debug] [MainThread]: On master: COMMIT
[0m16:38:49.158803 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:49.159082 [debug] [MainThread]: On master: COMMIT
[0m16:38:49.159951 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:38:49.160436 [debug] [MainThread]: On master: Close
[0m16:38:49.161357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:49.162014 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_meter_readings' was properly closed.
[0m16:38:49.162416 [info ] [MainThread]: 
[0m16:38:49.162802 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 1 table model, 1 view model in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m16:38:49.164074 [debug] [MainThread]: Command end result
[0m16:38:49.186263 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/manifest.json
[0m16:38:49.187996 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/semantic_manifest.json
[0m16:38:49.196136 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/target/run_results.json
[0m16:38:49.196776 [info ] [MainThread]: 
[0m16:38:49.197556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:49.198226 [info ] [MainThread]: 
[0m16:38:49.198906 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:38:49.201502 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.082236, "process_in_blocks": "0", "process_kernel_time": 0.327547, "process_mem_max_rss": "117760000", "process_out_blocks": "0", "process_user_time": 2.491792}
[0m16:38:49.202444 [debug] [MainThread]: Command `dbt build` succeeded at 16:38:49.202195 after 2.08 seconds
[0m16:38:49.203027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d943350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d81e0b0>]}
[0m16:38:49.203514 [debug] [MainThread]: Flushing usage events
[0m16:38:49.485350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:34.985493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bfed0>]}


============================== 13:51:35.001442 | 8d63f3b0-0dc6-467e-9335-135f274c241d ==============================
[0m13:51:35.001442 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:51:35.003060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jerome-norbit/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jerome-norbit/Documents/sandbox/vtec_dbt_test/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:51:35.502860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d63f3b0-0dc6-467e-9335-135f274c241d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6e520>]}
[0m13:51:35.559953 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:51:35.562472 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:51:35.565822 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8408923, "process_in_blocks": "0", "process_kernel_time": 0.657257, "process_mem_max_rss": "93343744", "process_out_blocks": "0", "process_user_time": 3.534256}
[0m13:51:35.566900 [debug] [MainThread]: Command `cli deps` succeeded at 13:51:35.566583 after 0.84 seconds
[0m13:51:35.567824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105850f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105852470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573bd50>]}
[0m13:51:35.568718 [debug] [MainThread]: Flushing usage events
[0m13:51:35.956588 [debug] [MainThread]: An error was encountered while trying to flush usage events
